define("template/index",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div sn-binding="class:menu"></div> <div sn-binding="html:title,class:titleClass"></div> <div class="head_msg" data-forward="/messages"> <i sn-binding="html:msg,display:msg|equal:0|not"></i> </div> </header> <div sn-binding="display:isLogin|not"> <div class="home_mask"></div> <div class="home_text" data-forward="/login"> <h1></h1> <h2>让回家的灯，为爱亮起来。</h2> <h3>开启时尚居家之旅</h3> <h4>LIFE STARTS HERE</h4> </div> <div class="launch"> <img src="images/launch0.jpg" /> <img src="images/launch1.jpg" class="launch_hide" /> <img src="images/launch2.jpg" class="launch_hide" /> </div> </div> <div sn-binding="display:isLogin"> <div class="main js_usescroll" data-index="0" sn-binding="class:isLogin|equal:true:\'\':\'isnotlogin\'"> <div class="home_bd"> <div class="home_vip"> <div class="rainbow"> <ul class="rainbow_points"> <li>0</li> <li>1,000</li> <li>5,000</li> <li>10,000</li> <li>50,000</li> </ul> <ul class="rainbow_vip"> <li>银卡</li> <li>金卡</li> <li>钻石</li> <li>VIP</li> <li>SVIP</li> </ul> <div class="rainbow_bd"> <div class="point" sn-binding="html:Point|round|formatMoney"></div> <div class="desc" sn-binding="html:currentLevel"></div> <div class="point_tip"> <div sn-binding="display:nextLevel|equal:0" class="max"> <p>活力值爆棚</p> <p>感谢您的⽀持和惠顾</p> </div> <div sn-binding="display:nextLevel|equal:0|not"> <span sn-binding="html:nextLevel|formatMoney"></span><b>活力值</b> <p>即可享有<em sn-binding="html:vip"></em>特权</p> </div> </div> </div> </div> <div class="home_points_bg"> <div class="home_points"></div> <div class="home_points"></div> <div class="home_points_cursor"></div> </div> </div> <ul class="home_ad"> <li sn-repeat="item in ads"> <img sn-binding="src:item.Src" sn-on="tap:openUrl:item.Url" /> </li> </ul> </div> </div> <div class="main" style="display:none" data-index="1"> </div> <div class="main" style="display:none" data-index="2"> <div class="baiduMap" sn-binding="html:baiduMap"> </div> </div> <div class="main home_my" style="display:none" data-index="3"> <div class="my"> <div class="card"> <div class="level"> <span sn-binding="html:currentLevel"></span> <span sn-binding="html:cardAmounts"></span> </div> <div class="point" sn-binding="html:id|format:\'ID:{0}\'"></div> <div class="barcode" sn-binding="html:barcode"> </div> <div class="mobile" sn-binding="html:user.Mobile"></div> </div> <ul class="myabs"> <li data-forward="/month"> <b>我的月礼</b> <span sn-binding="display:user.FreeMonths|isTrue" style="display:none">您还有<em sn-binding="html:user.FreeMonths|concat:\'个月\'"></em>会员礼可以领取。</span> <span sn-binding="display:user.FreeMonths|isFalse">继续努力，马上就可以获得免费领取特权了。</span> </li> <li data-forward="/mycard"> <b>我的卡券</b> <span>您现在拥有免邮卡<em sn-binding="html:user.FreeCouponsCount"></em>张，抵用券<em sn-binding="html:user.CouponsCount"></em>张。</span> </li> <li data-forward="/mypoint"> <b>我的积分</b> <span>您当前积分为<em sn-binding="html:user.Points|formatMoney"></em>。</span> </li> <li data-forward="/myorder"> <b>我买到的</b> <span sn-binding="display:user.OrderCount|isTrue" style="display:none">您目前在ABS共完成<em sn-binding="html:user.OrderCount"></em>次购物。</span> <span sn-binding="display:user.OrderCount|isFalse"> 您还未购买过商品，立即开启您的购物之旅。</span> </li> </ul> </div> </div> </div> <ul class="footer" sn-binding="display:isLogin"> <li class="curr">首页</li> <li>马上购物</li> <li>附近门店</li> <li>我</li> </ul> <div class="open_msg" style="display:none"> <div class="msg_bd" sn-binding="html:message"></div> </div>';return __},helpers:{}});return T.template=T.html,T});define("template/menu",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<div class="menu_bd"> <div class="menu_user" sn-binding="data-back:memberUrl"> <div class="menu_username" sn-binding="display:user"> <h1> <text sn-binding="html:user.UserName|or:user.Mobile"></text> <span>编辑信息</span> </h1> <h2 sn-binding="html:user.BirthDay|date:\'yyyy/MM/dd\'"></h2> </div> <div class="menu_username" sn-binding="display:user|isFalse" style="display:none"> <div class="btn_mid">登录</div> </div> </div> <ul class="menu_list menu_my"> <li data-forward="/month">我的月礼</li> <li data-forward="/mycard">我的卡券</li> <li data-forward="/mypoint">我的积分</li> <li data-forward="/myorder">我买到的</li> </ul> <ul class="menu_list menu_service"> <li data-forward="/guide">新手指南</li> <li><a href="tel:4008205077">联系客服</a></li> </ul> <ul class="menu_list menu_settings"> <li data-forward="/settings">设置</li> </ul> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/menu",["images/style.css","$","util","activity","bridge","core/model","../widget/scroll","../widget/loading"],function(i,e,s){{var t=(i("$"),i("util")),l=i("activity"),a=i("bridge"),d=i("core/model"),r=i("../widget/scroll");i("../widget/loading")}return l.extend({toggleAnim:"menu",className:"menu",events:{tap:function(i){},"tap [data-logout]":function(i){}},swipeLeftBackAction:"/",onCreate:function(){r.bind(this.$(".menu_bd")),a.hasStatusBar&&this.$el.find(".fix_statusbar").addClass("fix_statusbar"),this.model=new d.ViewModel(this.$el,{}),this.onShow()},onShow:function(){var e=t.store("user");e?(this.user=e,this.model.set({memberUrl:"/member",logoutOrLogin:"退出",user:e})):this.model.set({memberUrl:"/login",logoutOrLogin:"登录",user:null})},onDestory:function(){}})});define("views/index",["images/style.css","$","util","activity","bridge","../widget/loading","../widget/slider","../core/model","../widget/scroll","../widget/barcode","../util/barcode","animation"],function(e,i,s){var t=e("$"),n=e("util"),a=e("activity"),l=e("bridge"),d=e("../widget/loading"),r=(e("../widget/slider"),e("../core/model")),m=e("../widget/scroll"),c=(e("../widget/barcode"),e("../util/barcode")),p=e("animation"),h=[1e3,4e3,5e3,45e3],v=function(e){for(var i=0,s=0;s<h.length;s++){if(e<=h[s]){i+=25*e/h[s];break}i+=25,e-=h[s]}return i};return a.extend({events:{tap:function(e){e.target==this.el&&this.back("/")},"tap .open_msg":function(e){t(e.target).hasClass("open_msg")&&t(e.target).removeClass("show")},"tap .head_menu":function(e){this.forward("/menu")},"tap .js_comment_list [data-id]":function(e){},"tap .rainbow_bd":function(e){this.$(".footer li").eq(3).trigger("tap")},"tap .footer li":function(e){var i=this,s=t(e.currentTarget),a=s.index();1==a?l.openInApp(this.user.OpenUrl||"http://m.abs.cn"):s.hasClass("curr")||(s.addClass("curr").siblings(".curr").removeClass("curr"),this.$main.eq(a).show().siblings(".main").hide(),2!=a||this.model.data.baiduMap||(this.model.set("baiduMap",'<iframe class="js_baidu_map" src="'+l.url("/baiduMap.html")+'" frameborder="0" ></iframe>'),this.$baiduMap=this.$(".js_baidu_map").css({width:window.innerWidth,height:window.innerHeight-47-44-(n.isInApp?20:0)}),l.getLocation(function(e,s){i.$baiduMap.src=l.url("/baiduMap.html#longitude="+e+"&latitude="+latitude)})))}},swipeRightForwardAction:"/menu",className:"home",titles:["欢迎来到ABS会员俱乐部","马上购物","附件门店","我"],onCreate:function(){var e=this;t.get(l.url("/api/settings/update?version="+sl.appVersion),function(i){i.success&&i.updateUrl&&e.confirm(i.text,function(){l.open(i.updateUrl,{target:"browser"})})},"json"),r.Filter.formatMoney=n.formatMoney,this.model=new r.ViewModel(this.$el,{menu:"head_menu",titleClass:"head_title",title:"ABS + CLUB",isLogin:!!n.store("user"),msg:0,open:function(){l.openInApp(e.user.OpenUrl||"http://m.abs.cn")},openUrl:function(e,i){l.openInApp(i||"http://m.abs.cn")}});var i=this.$main=this.$(".main");m.bind(i.filter(".js_usescroll"),{useScroll:!0}),m.bind(i.filter(":not(.js_usescroll)")),this.$points=this.$(".home_points"),this.$cursor=this.$(".home_points_cursor"),e.$open_msg=this.$(".open_msg").on(t.fx.transitionEnd,function(i){e.$open_msg.hasClass("show")||e.$open_msg.hide()}),m.bind(e.$open_msg.find(".msg_bd")),this.userLoading=new d({url:"/api/user/get",check:!1,checkData:!1,$el:this.$el,success:function(i){t.extend(e.user,i.data),n.store("user",e.user),e.model.set({user:e.user}),e.showPoints(),e.getUnreadMsg(),i.vdpMessage&&(e.$open_msg.show(),e.$open_msg[0].clientHeight,e.$open_msg.addClass("show"),e.model.set({message:i.vdpMessage}))}}),this.adLoading=new d({url:"/api/settings/ad_list?name=index1",check:!1,checkData:!1,$el:this.$el.find(".home_ad"),success:function(i){e.model.set({ads:i.data});var s=e.$(".home_ad > li");s.each(function(e){var i=this;setTimeout(function(){i.className="toggle"},100*(e+1))})}});var s=this.$(".launch img"),a=this.$(".home_mask").on(t.fx.transitionEnd,function(e){if(a.hasClass("toggle")){a.removeClass("toggle");var i=s.filter(":not(.launch_hide)").addClass("launch_hide");s.eq(i.index()+1==s.length?0:i.index()+1).removeClass("launch_hide")}});setTimeout(function(){a.addClass("toggle"),setTimeout(arguments.callee,3200)},3200)},setRainbow:function(){var a,l,o,e=this,i=Math.round(this.user.Amount),s=v(i),t=s/50*117-117,r=["银卡会员","金卡会员","钻石会员","VIP会员","SVIP会员","无敌会员"];e.model.set("vip",i<(o=1e3)?(a=0,l=1e3-i,r[1]):i<(o=5e3)?(a=1,l=5e3-i,r[2]):i<(o=1e4)?(a=2,l=1e4-i,r[3]):i<(o=5e4)?(a=3,l=5e4-i,r[4]):(a=4,l="0",r[5])),this.$(".rainbow_vip :nth-child("+(a+1)+")").addClass("curr"),e.model.set("nextLevel","+"+l),e.model.set("currentLevel",r[a]),e.model.set("levelAmounts",o),e.model.set("cardAmounts","("+n.formatMoney(i)+(i>5e4?"":"/"+n.formatMoney(o))+")"),i!=e.model.data.point&&(e.model.set("point",i),p.animate(function(s){var a=p.step(-117,t,s),l=Math.round(p.step(0,i,s)),d=n.circlePoint(0,0,91,90-a);d.x>0?0==t?d.x=0:55>t?(d.x-=4,d.y+=2):80>t?d.x-=7:(d.x-=9,d.y+=2):d.y+=2,e.model.set("Point",l),e.$cursor.css({"-webkit-transform":"rotate("+t+"deg)",top:91-d.y,left:91+d.x})},800,"ease-out"),s>50&&this.$points.eq(0).animate({rotate:"0deg"},800,"ease-out"),this.$points.eq(1).animate({rotate:t+"deg"},800,"ease-out"))},getUnreadMsg:function(){var e=this;t.get(l.url("/api/user/get_unread_msg_count"),{UserID:e.user.ID,Auth:e.user.Auth},function(i){i.success&&e.model.set("msg",i.count)},"json")},onShow:function(){var e=this;e.user=n.store("user");var i=!!e.user;if(e.model.set("isLogin",i),i)if(e.showPoints(),e.model.set("barcode",c.code93(e.user.Mobile).replace(/0/g,"<em></em>").replace(/1/g,"<i></i>")).set("user",e.user),!this.userLoaded&&(this.userLoaded=!0)){var s=function(i){e.userLoading.setParam({UserID:e.user.ID,Auth:e.user.Auth,IMEI:i||"CAN_NOT_GET"}).load()};n.isInApp?l.getDeviceToken(s):s(),this.adLoading.load()}else this.getUnreadMsg()},showPoints:function(){this.setRainbow(this.user.Amount),this.$(".point_tip").addClass("show")},onPause:function(){},onDestory:function(){}})});define("views/about",["images/style.css","$","util","activity","../core/model","../widget/scroll","animation"],function(e,i,s){{var a=(e("$"),e("util"),e("activity")),l=e("../core/model"),o=e("../widget/scroll");e("animation")}return a.extend({events:{},swipeRightBackAction:"/settings",onCreate:function(){var i=this.$(".main");o.bind(i),this.model=new l.ViewModel(this.$el,{back:"/settings",title:"隐私政策"})},onShow:function(){},onDestory:function(){}})});define("template/about",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main"> <div class="aboutus"> ABS尊重并保护所有使用ABS平台服务用户的个人隐私权。为了给您提供更准确、更有个性化的服务，ABS会按照本隐私权政策的规定使用和披露您的个人信息。但ABS将以高度的勤勉、审慎义务对待这些信息。除本隐私权政策另有规定外，在未征得您事先许可的情况下，ABS不会将这些信息对外披露或向第三方提供。ABS会不时更新本隐私权政策。您在同意ABS服务协议之时，即视为您已经同意本隐私权政策全部内容。本隐私权政策属于ABS服务协议不可分割的一部分。<br><br> <b>1. 适用范围</b><br> a） 在您注册或激活可以登录ABS平台的账户时，您在ABS平台提供的个人注册信息（应法律法规要求需公示的企业名称等相关工商注册信息以及自然人经营者的信息除外）；<br> b） 在您使用ABS平台服务，或访问ABS平台网页时，ABS自动接收并记录的您的浏览器和计算机上的信息，包括但不限于您的IP地址、浏览器的类型、使用的语言、 访问日期和时间、软硬件特征信息及您需求的网页记录等数据；如您下载或使用ABS或其关联公司移动客户端软件，或访问移动网页使用ABS平台服务时，ABS可能会读取与您位置和移动设备相关的信息，包括但不限于设备型号、设备识别码、操作系统、分辨率、电信运营商等。<br> c） ABS通过合法途径从商业伙伴处取得的用户个人数据。<br> 您了解并同意，以下信息不适用本隐私权政策：<br> a）您在使用ABS平台提供的搜索服务时输入的关键字信息；<br> b）ABS收集到的您在ABS进行交易的有关数据，包括但不限于出价、成交信息及评价详情；<br> c）信用评价、违反法律规定或违反ABS规则行为及ABS已对您采取的措施。<br><br> <b>2. 信息使用</b><br> a) ABS不会向任何无关第三方提供、出售、出租、分享或交易您的个人信息，除非事先得到您的许可，或该第三方和ABS单独或共同为您提供服务，且在该服务结束后，其将被禁止访问包括其以前能够访问的所有这些资料。<br> b)ABS亦不允许任何第三方以任何手段收集、编辑、出售或者无偿传播您的个人信息。任何ABS平台用户如从事上述活动，一经发现，ABS有权立即终止与该用户的服务协议。<br> c) 为服务用户的目的，ABS或其关联公司可能通过使用您的个人信息，向您提供您可能感兴趣的信息，包括但不限于向您发出产品和服务信息，或通过系统向您展示个性化的第三方推广信息，或者与ABS合作伙伴共享信息以便他们向您发送有关其产品和服务的信息（后者需要您的事先同意）。<br> d) ABS可以使用您的个人信息以预防、发现、调查欺诈、危害安全、非法或违反与ABS或其关联公司协议、政策或规则的行为，以保护您、其他ABS用户，或ABS或其关联公司合法权益。<br><br> <b>3. 信息存储和交换</b><br> ABS收集的有关您的信息和资料将保存在ABS及（或）其关联公司的服务器上，这些信息和资料可能传送至您所在国家、地区或ABS收集信息和资料所在地的境外并在境外被访问、存储和展示。<br><br> <b>4. Cookie的使用</b><br> a) 在您未拒绝接受cookies的情况下，ABS会在您的计算机上设定或取用cookies，以便您能登录或使用依赖于cookies的ABS平台服务或功能。ABS使用cookies可为您提供更加周到的个性化服务，包括推广服务。<br> b) 您有权选择接受或拒绝接受cookies。您可以通过修改浏览器设置的方式拒绝接受cookies。但如果您选择拒绝接受cookies，则您可能无法登录或使用依赖于cookies的ABS平台服务或功能。<br> c) 通过ABS所设cookies所取得的有关信息，将适用本政策；<br><br> <b>5. 未成年人的特别注意事项</b><br> 如果您不是具备完全民事权利能力和完全民事行为能力的自然人，您无权使用ABS平台服务，因此ABS希望您不要向我们提供任何个人信息。<br><br> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("template/member",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main scrollview"> <div class="member"> <dl class="member_info"> <dt>登录名</dt> <dd><p sn-binding="html:user.Mobile"></p></dd> <dt>姓名</dt> <dd><input sn-binding="value:user.UserName" sn-model="user.UserName" /></dd> <dt>性别：</dt> <dd> <span class="radio" sn-model="user.Gender" value="1" sn-binding="class:user.Gender|case:\'1\':\'checked\':\'\'">男</span> <span class="radio" sn-model="user.Gender" value="2" sn-binding="class:user.Gender|case:\'2\':\'checked\':\'\'">女</span> </dd> <dt>生日</dt> <dd><input type="text" sn-binding="value:user.BirthDay|date:\'yyyy/MM/dd\'" sn-model="user.BirthDay" /></dd> <dt>所在地</dt> <dd sn-on="tap:showCity"><p sn-binding="html:user.City"></p></dd> <dt>家庭人数</dt> <dd><input sn-binding="value:user.FamilySize" sn-model="user.FamilySize" /></dd> <dt>是否有小孩：</dt> <dd> <span class="radio" sn-model="user.HasChild" value="1" sn-binding="class:user.HasChild|equal:true:\'checked\':\'\'">是</span> <span class="radio" sn-model="user.HasChild" value="0" sn-binding="class:user.HasChild|equal:false:\'checked\':\'\'">否</span> </dd> <dt>小孩生日</dt> <dd><input type="text" sn-binding="value:user.ChildBirthDay" sn-model="user.ChildBirthDay" /></dd> </dl> <div class="member_bar"> <b class="btn_mid" sn-on="tap:submit" sn-binding="class:submiting|equal:true:\'disabled\':\'\'">修改</b> </div> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("views/settings",["images/style.css","$","util","activity","../widget/loading","../core/model","../widget/scroll","animation"],function(e,i,s){{var n=(e("$"),e("util")),a=e("activity"),l=(e("../widget/loading"),e("../core/model")),r=e("../widget/scroll");e("animation")}return a.extend({events:{"tap .js_bind:not(.disabled)":function(){}},swipeRightBackAction:"/",onCreate:function(){var e=this,i=this.$(".main");r.bind(i);var s=n.store("user");this.model=new l.ViewModel(this.$el,{back:"/",title:"设置",user:s,logout:function(){localStorage.getItem("user")?(n.store("user",null),e.back("/")):e.forward("/login")}})},onShow:function(){},onDestory:function(){}})});define("template/settings",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main settings"> <div class="hello"> <div class="name" sn-binding="html:user.UserName|or:\'亲爱的用户\'"></div> <div class="text">你好！</div> </div> <ul class="con"> <li data-forward="/member?from=/settings">账户信息</li> <li data-forward="/about?from=/settings">隐私政策</li> </ul> <div class="ft"> <b class="btn_large" sn-on="tap:logout" sn-binding="html:user|equal:null:\'立即登录\':\'退出登录\'"></b> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/login",["images/style.css","$","util","activity","../widget/loading","../core/model","../widget/scroll","animation"],function(e,i,s){{var t=e("$"),n=e("util"),a=e("activity"),l=e("../widget/loading"),d=e("../core/model"),r=e("../widget/scroll");e("animation")}return a.extend({events:{"tap .js_login:not(.disabled)":function(){var e=this.model.get("mobile"),i=this.model.get("smsCode");return e&&n.validateMobile(e)?i?void this.loading.setParam({mobile:e,smsCode:i}).load():void sl.tip("请输入密码"):void sl.tip("请输入正确的手机")},"tap .js_valid:not(.disabled)":function(e){var i=this.model.get("mobile");return i&&n.validateMobile(i)?(this.$valid.addClass("disabled"),this.valid.setParam({mobile:this.model.data.mobile}),void this.valid.load()):void sl.tip("请输入正确的手机")}},swipeRightBackAction:"/",validTimeout:function(){var e=this,i=localStorage.getItem("valid_time");if(i&&parseInt(i)>60){if(i=Math.round((new Date(parseInt(i)).getTime()-Date.now())/1e3),0>=i)return;e.$valid.addClass("disabled"),setTimeout(function(){0>=i?(e.$valid.removeClass("disabled"),e.model.set("valid","获取验证码"),localStorage.removeItem("valid_time")):(e.model.set("valid",i+"秒后再次获取"),i--,setTimeout(arguments.callee,1e3))},1e3)}},onCreate:function(){var e=this,i=this.$(".main");r.bind(i),this.model=new d.ViewModel(this.$el,{title:"快速登录 / 注册",valid:"获取验证码",back:this.route.query.from||"/"}),this.getUser=new l({url:"/api/user/get",check:!1,checkData:!1,$el:this.$el,success:function(){}}),this.loading=new l({url:"/api/user/login",method:"POST",check:!1,checkData:!1,$el:this.$el,success:function(i){i.success?(n.store("user",i.data),e.getUser.setParam({UserID:i.data.UserID,Auth:i.data.Auth}).load(function(s,a){a&&n.store("user",t.extend(i.data,a.data)),e.back(e.route.query.success||"/")})):sl.tip(i.msg)},error:function(e){sl.tip(e.msg)}}),this.valid=new l({url:"/api/user/send_sms",method:"POST",params:{mobile:e.model.data.mobile},check:!1,checkData:!1,$el:this.$el,success:function(i){i.success?(localStorage.setItem("valid_time",Date.now()+6e4),e.validTimeout()):sl.tip(i.msg)},error:function(i){sl.tip(i.msg),e.$valid.removeClass("disabled"),this.hideLoading()}}),e.$valid=this.$(".js_valid"),e.validTimeout()},onShow:function(){},onDestory:function(){}})});define("template/login",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div sn-binding="html:title" class="head_title"></div> <div class="head_back" sn-binding="data-back:back"></div> </header> <div class="main"> <div class="login_form"> <h1 class="login_hd">注册/登录</h1> <ul class="form"> <li class="form_mobile"><input placeholder="请输入您的手机号码" sn-model="mobile" /></li> <li><input placeholder="请输入短信验证码" sn-model="smsCode" type="text" /><b class="js_valid btn_middle" sn-binding="html:valid"></b></li> </ul> <div class="login_btn"><b class="btn_large js_login">手机号登录</b> </div> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("views/member",["images/style.css","$","util","activity","core/model","../widget/scroll","bridge","../widget/loading","../widget/selector"],function(e,i,s){var t=e("$"),a=e("util"),n=e("activity"),l=e("core/model"),r=(e("../widget/scroll"),e("bridge")),o=e("../widget/loading"),c=e("../widget/selector");return n.extend({events:{"tap .radio":function(e){var i=t(e.currentTarget),s=e.currentTarget.getAttribute("value");this.model.set(i.attr("sn-model"),s)}},onCreate:function(){var e=this;e.swipeRightBackAction=this.route.query.from||"/",this.model=new l.ViewModel(this.$el,{title:"个人信息",back:e.swipeRightBackAction,showCity:function(){var s=a.indexOf(e.provinceList,function(i){return i.PRV_ID==e.model.data.user.ProvID});-1!=s&&(e.city.eq(0).index(s),i(e.model.data.user.ProvID)),e.city.show()},submit:function(){this.set("submiting",!0);var i=this.data.user;e.update.setParam({ID:i.ID,Auth:i.Auth,UserName:i.UserName,Gender:i.Gender,BirthDay:i.BirthDay&&a.formatDate(i.BirthDay),ChildBirthDay:i.ChildBirthDay&&a.formatDate(i.ChildBirthDay),CityID:i.CityID,FamilySize:i.FamilySize,HasChild:i.HasChild}).load()}}),this.update=new o({url:"/api/user/update",check:!1,checkData:!1,$el:this.$el,success:function(i){i.success?(a.store("user",e.model.data.user),sl.tip("修改成功")):sl.tip(i.msg),e.model.set("submiting",!1)}}),this.city=new c({options:[{template:"<li><%=PRV_DESC%></li>",data:[],onChange:function(e,s,t){i(t.PRV_ID)}},{template:"<li><%=CTY_DESC%></li>",data:[]}],complete:function(i){e.model.set("user.City",i[1].CTY_DESC),e.model.set("user.CityID",i[1].CTY_ID),e.model.set("user.ProvID",i[1].CTY_PRV_ID)}});var i=function(i){var s=a.find(e.cityList,function(e){return e.CTY_PRV_ID==i});if(s.unshift({CTY_PRV_ID:i,CTY_ID:0,CTY_DESC:"请选择"}),e.city.eq(1).set(s),e.model.data.user){var t=a.indexOf(s,function(i){return i.CTY_ID==e.model.data.user.CityID});-1!=t&&e.city.eq(1).index(t)}};t.get(r.url("/api/user/get_city"),function(s){s.province.unshift({PRV_ID:0,PRV_DESC:"请选择"}),e.city.eq(0).set(s.province),e.provinceList=s.province,e.cityList=s.data,i(s.province[0].PRV_ID)},"json")},onShow:function(){var e=this,i=a.store("user");i?(e.user=i,this.loading=new o({url:"/api/user/get",check:!1,checkData:!1,params:{UserID:i.ID,Auth:i.Auth},$el:this.$el,success:function(s){e.user=i=t.extend(i,s.data),a.store("user",i),e.model.set({user:i,"NickName.input":i.NickName,"Address.input":i.Address})}}),this.loading.load()):this.forward("/login")},onDestory:function(){}})});define("template/month",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main mymonth"> <div sn-binding="display:user.FreeMonths|not|equal:0"> <div class="month_present"> <img sn-binding="src:currentMonth.FRE_PIC1" sn-on="tap:openPresent:currentMonth"/> </div> <div class="month_notice"> 不要忘记啦！您还有<em sn-binding="html:user.FreeMonths"></em>个月的会员礼可以领取哟！ </div> <ul class="month"> <li sn-repeat="item in data" sn-binding="class:item|eval:\'($0.Overdue||$0.LPF_PUR_ID)&&$0.CanGet?\\\'overdue curr\\\':($0.Overdue||$0.LPF_PUR_ID)?\\\'overdue\\\':$0.CanGet?\\\'curr\\\':\\\'\\\'\',data-year:item.Year" sn-on="tap:openPresent:item"> <i class="flag" sn-binding="html:item.Year|concat:\'年\',display:item.Year" style="display:none"></i> <img sn-binding="src:item.FRE_TITLE_PIC,display:item.FRE_TITLE_PIC" /> <span sn-binding="html:item|eval:\'$0.Overdue||$0.LPF_PUR_ID?\\\'\\\':($0.Month+\\\'月\\\')\',class:item|eval:\'$0.Overdue?\\\'over\\\':$0.LPF_PUR_ID?\\\'get\\\':\\\'\\\'\'"></span> <em sn-binding="display:item.CanGet" style="display:none">立即领取</em> </li> </ul> </div> <div class="my_nodata" sn-binding="display:user.FreeMonths|equal:0" style="display:none"> <div class="icon"></div> <div class="text">您目前还没有免费领取特权哦！</div> <div class="btn" sn-on="tap:open">去逛逛吧</div> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("views/month",["images/style.css","$","util","activity","../widget/loading","../core/model","../core/promise","../widget/scroll","animation","bridge"],function(e,i,s){var n=(e("$"),e("util")),a=e("activity"),l=e("../widget/loading"),d=e("../core/model"),r=e("../core/promise"),o=e("../widget/scroll"),u=(e("animation"),e("bridge"));return a.extend({events:{"tap .js_comment":function(){this.forward("/destcomment/"+this.route.data.id)}},swipeRightBackAction:"/",onCreate:function(){var e=this;this.promise=new r,this.$main=this.$(".main"),o.bind(this.$main),this.model=new d.ViewModel(this.$el,{title:"我的月礼",back:this.route.query.from||"/",user:n.store("user"),openPresent:function(e,i){i.data.CanGet&&u.openInApp("http://m.abs.cn123/free/"+i.data.FRE_ID+".html")},open:function(){u.openInApp(e.user.OpenUrl||"http://m.abs.cn")}}),this.loading=new l({url:"/api/user/get_month_free",params:{id:this.route.data.id},check:!1,checkData:!1,$el:this.$el,$content:this.$main.children(":first-child"),$scroll:this.$main,success:function(i){e.model.set({currentMonth:i.currentMonth,data:i.data})}})},onShow:function(){var e=this;e.user=this.model.data.user||n.store("user"),e.user?(e.model.set({user:e.user}),!e.isLoad&&(e.isLoad=!0)&&e.loading.setParam({UserID:e.user.ID,Auth:e.user.Auth}).load()):e.forward("/login?success="+this.route.url+"&from=/")},onDestory:function(){}})});define("template/mycard",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <ul class="mycard_hd"> <li sn-binding="class:isOverdue|equal:false:\'curr\':\'\'" sn-on="tap:isOverdue=false">抵用券</li> <li sn-binding="class:isOverdue|equal:false:\'\':\'curr\'" sn-on="tap:isOverdue=true">免邮卡</li> </ul> <div class="main mycard"> <ul class="mycard_con js_not_overdue" sn-binding="display:isOverdue|not"> <!-- <li class="free"> <div class="name">免邮券</div> <div class="time"><div class="hd">有效期</div><div class="con">2015/07/30</div></div> </li>--> <li sn-repeat="item in data" sn-binding="class:item.VCA_DEDUCT_AMOUNT|cardClass:item.VCA_VCT_ID,class:item.isOverdue|equal:true:\'dis\':\'\'"> <div class="price" sn-binding="html:item.VCA_DEDUCT_AMOUNT|currency,display:item.VCA_VCT_ID|equal:4|not"></div> <div class="name" sn-binding="html:item.VCA_VCT_ID|equal:4:\'免邮卡\':item.VCA_NAME"><!--单笔订单满300可用--></div> <div class="time"><div class="hd">有效期</div><div class="con" sn-binding="html:item.CSV_START_DT|date:\'yyyy/MM/dd\'|concat:\'至\',display:item.isOverdue|not"></div><div class="con" sn-binding="html:item.CSV_END_DT|date:\'yyyy/MM/dd\',display:item.isOverdue|not"></div><div class="overdue" sn-binding="display:item.isOverdue" style="display:none">已过期</div></div> </li> </ul> <ul class="mycard_con js_overdue" sn-binding="display:isOverdue"> <li sn-repeat="item in data1" sn-binding="class:item.VCA_VCT_ID|equal:4:\'free\':\'\',class:item.isOverdue|equal:true:\'dis\':\'\'"> <div class="price" sn-binding="html:item.VCA_DEDUCT_AMOUNT|currency,display:item.VCA_VCT_ID|equal:4|not"></div> <div class="name" sn-binding="html:item.VCA_VCT_ID|equal:4:\'免邮卡\':item.VCA_NAME"><!--单笔订单满300可用--></div> <div class="time"><div class="hd">有效期</div><div class="con" sn-binding="html:item.CSV_START_DT|date:\'yyyy/MM/dd\'|concat:\'至\',display:item.isOverdue|not"></div><div class="con" sn-binding="html:item.CSV_END_DT|date:\'yyyy/MM/dd\',display:item.isOverdue|not"></div><div class="overdue" sn-binding="display:item.isOverdue" style="display:none">已过期</div></div> </li> </ul> <div class="my_nodata" sn-binding="display:data|eval:\'$1?!$2.length:!$0.length\':isOverdue:data1" style="display:none"> <div class="icon"></div> <div class="text">您目前还没有卡券哦</div> <div class="btn" sn-on="tap:open">去逛逛吧</div> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/mycard",["images/style.css","$","util","activity","../widget/loading","../core/model","../widget/scroll","animation","bridge"],function(e,i,s){var n=(e("$"),e("util")),a=e("activity"),d=e("../widget/loading"),l=e("../core/model"),r=e("../widget/scroll"),c=(e("animation"),e("bridge")),u=function(e){if(!e.eq(0).hasClass("show")&&e.length){var i=e.length,s=i-1;e.parent().css({height:100*i}),e.each(function(e,i){i.style.zIndex=e}),setTimeout(function(){var i=arguments.callee,t=e.eq(s);t[0].clientHeight,t.addClass("show"),setTimeout(function(e){return function(){t.animate({opacity:1,translate:"0px,"+100*e+"px"},450*e,"ease-out"),s--,s>=0&&i()}}(s),300)},200)}};return a.extend({events:{},swipeRightBackAction:"/",onCreate:function(){var e=this,i=this.$(".main");r.bind(i),l.Filter.cardClass=function(e,i){return 4==i?"free":2==i?"price10":1==i?"price50":""},this.model=new l.ViewModel(this.$el,{back:"/",title:"我的卡券",isOverdue:!1,open:function(){c.openInApp(e.user.OpenUrl||"http://m.abs.cn")}}),e.loading=new d({url:"/api/user/voucher_list",params:{status:1},$el:this.$el,check:!1,checkData:!1,success:function(i){if(i.closeNumber&&e.confirm("您有"+i.closeNumber+"张优惠券马上就要过期啦，<br>尽快使用哦",function(){}),i&&i.data&&0!=i.data.length){var s=n.find(i.data,function(e){return 4!=e.VCA_VCT_ID});s.sort(function(e,i){return e.isOverdue&&!i.isOverdue?1:!e.isOverdue&&i.isOverdue?-1:e.CSV_END_DT>i.CSV_END_DT?1:e.CSV_END_DT==i.CSV_END_DT?0:-1}),e.model.set("data",s);var t=n.find(i.data,function(e){return 4==e.VCA_VCT_ID});t.sort(function(e,i){return e.isOverdue&&!i.isOverdue?1:!e.isOverdue&&i.isOverdue?-1:e.CSV_END_DT>i.CSV_END_DT?1:e.CSV_END_DT==i.CSV_END_DT?0:-1}),e.model.set("data1",t);var a=e.$(".js_not_overdue").children("li");u(a)}else e.model.set("data",[]),e.model.set("data1",[])}}),e.model.on("change:isOverdue",function(){if(e.model.data.isOverdue){var i=e.$(".js_overdue").children("li");u(i)}}),e.user=n.store("user")},onShow:function(){var e=this;e.user=n.store("user"),e.user?!e.isLoad&&(e.isLoad=!0)&&e.loading.setParam({UserID:e.user.ID,Auth:e.user.Auth}).load():e.forward("/login?success="+this.route.url+"&from=/")},onDestory:function(){}})});define("template/messages",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main message_center"> <div class="message_card" sn-repeat="item in data"> <div class="hd"> <h2 sn-binding="html:item.MSG_TITLE"></h2> <h3 sn-binding="html:item.MSG_DT|date:\'yyyy.MM.dd\'"></h3> </div> <div class="bd" sn-binding="html:item.MSG_CONTENT"></div> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/messages",["images/style.css","$","util","activity","../widget/loading","../core/model","../widget/scroll","animation"],function(e,i,s){{var n=(e("$"),e("util")),a=e("activity"),d=e("../widget/loading"),l=e("../core/model"),r=e("../widget/scroll");e("animation")}return a.extend({events:{},onCreate:function(){var e=this,i=this.$(".main");r.bind(i),this.model=new l.ViewModel(this.$el,{back:"/",title:"消息中心"}),this.loading=new d({url:"/api/user/get_msg",$el:this.$el,checkData:!1,success:function(i){i.data||this.showError("暂无消息"),e.model.set("data",i.data)},append:function(i){e.model.get("data").append(i.data)}})},onShow:function(){var e=this;e.user=n.store("user"),e.user?e.loading.setParam({UserID:e.user.ID,Auth:e.user.Auth}).load():e.forward("/login?success="+this.route.url+"&from=/")},onDestory:function(){}})});define("views/mypoint",["images/style.css","$","util","activity","../widget/loading","../core/model","../widget/scroll","animation"],function(e,i,s){{var n=(e("$"),e("util")),a=e("activity"),d=e("../widget/loading"),l=e("../core/model"),r=e("../widget/scroll");e("animation")}return a.extend({events:{},swipeRightBackAction:"/",onCreate:function(){var e=this,i=this.$(".main");r.bind(i),this.model=new l.ViewModel(this.$el,{back:"/",title:"我的积分",open:function(){bridge.openInApp(e.user.OpenUrl||"http://m.abs.cn")}})},onShow:function(){var e=this,e=this,i=n.store("user");i?(e.user=i,this.loading=new d({url:"/api/user/get_points",check:!1,checkData:!1,params:{UserID:i.ID,Auth:i.Auth},$el:this.$el,success:function(i){e.model.set(i)}}),this.loading.load()):this.forward("/login")},onDestory:function(){}})});define("template/mypoint",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main mypoint"> <div sn-binding="display:points|equal:0|not"> <div class="curr">当前积分：<b sn-binding="html:points"></b></div> <div class="notice">*您的积分可以直接抵扣现金使用。<span>（100积分＝1元）</span></div> <div class="hd">积分记录</div> <ul class="mypoint_list"> <li sn-repeat="item in data"> <p class="from" sn-binding="html:item.HPT_PIT_ID|equal:1:item.CNL_DESC:item.POT_DESC"></p> <p class="date" sn-binding="html:item.HPT_DT|date:\'yyyy.MM.dd\'"></p> <p class="points" sn-binding="html:item.HPT_POINT_AMOUNT|round|eval:\'$0>0?\\\'+\\\'+$0:$0\',class:item.HPT_POINT_AMOUNT|lt:0|equal:true:\'minus\':\'\'"></p> </li> </ul> </div> <div class="my_nodata" sn-binding="display:points|equal:0" style="display:none"> <div class="icon"></div> <div class="text">您目前还没有积分记录哦</div> <div class="btn" sn-on="tap:open">去逛逛吧</div> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("template/myorder",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <ul class="myorder_hd" sn-binding="display:data|eval:\'$0&&$0.length||($1!=0)\':\'currentType\'"> <li class="curr" sn-on="tap:select:0">全部</li> <li sn-on="tap:select:1">待付款</li> <li sn-on="tap:select:2">待发货</li> <li sn-on="tap:select:3">配送中</li> <li sn-on="tap:select:4">已完成</li> </ul> <div class="main myorder"> <ul class="con" sn-binding="display:data"> <li sn-repeat="item in data" sn-binding="class:item.CNL_CLT_ID|format:\'type{0}\'"> <div class="hd"><b class="from" sn-binding="html:item.CNL_DESC"></b><span class="status" sn-binding="html:item.PUS_DESC"></span></div> <div class="info"> <span sn-binding="html:item.PUR_CODE|format:\'订单号：{0}\'"></span> <span sn-binding="html:item.PUR_DT|date"></span> </div> <div class="bd" sn-repeat="prd in item.Children" sn-on="tap:openPrd:prd"> <img sn-binding="src:prd.WPP_LIST_PIC|or:\'images/default.jpg\'" src="images/default.jpg" onerror="this.src=\'images/default.jpg\'" /> <div class="con"> <h2 sn-binding="html:prd.PRD_NAME"></h2> <h3>颜色：<span sn-binding="html:prd.PRD_COLOR"></span></h3> <h4>尺寸：<span sn-binding="html:prd.PRD_SPEC"></span></h4> </div> <p class="priceinfo"> <span class="price" sn-binding="html:prd.PRD_MEMBER_PRICE|currency:\'￥\'"></span> <span class="qty" sn-binding="html:prd.LPK_QTY|format:\'x{0}\'"></span> </p> </div> <div class="ft"> 总价：<span sn-binding="html:item.PUR_AMOUNT|currency:\'￥\'"></span> <b class="btn_sml" sn-binding="display:item.XPU_EXPRESS_CODE|equal:null|not" sn-on="tap:showExpress:item">查看物流</b> </div> <div class="express" sn-binding="display:item.showExpress" style="display:none"> <div class="express_con"> <p>物流公司：<span sn-binding="html:item.EXP_NAME"></span></p> <p>运单号码：<span sn-binding="html:item.XPU_EXPRESS_CODE"></span></p> <p>如需跟踪物流详情 请复制运单号前往<span sn-binding="html:item.EXP_NAME"></span>官方网站查询</p> </div> </div> </li> </ul> <div class="my_nodata" sn-binding="display:data|eval:\'$1==0&&(!$0||!$0.length)\':currentType" style="display:none"> <div class="icon"></div> <div class="text">您目前还没有购物记录哦</div> <div class="btn" sn-on="tap:open">去逛逛吧</div> </div> <div class="my_nodata" sn-binding="display:data|eval:\'$1!=0&&(!$0||!$0.length)\':currentType" style="display:none"> <div class="icon"></div> <div class="text">您还没有相关的订单</div> <div class="btn" sn-on="tap:open">去逛逛吧</div> </div> </div> <div class="open_msg" style="display:none"> <div class="msg_bd msg_alert"> 这款产品已经售罄喽 <div class="btn_go">随便逛逛</div> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/myorder",["images/style.css","$","util","activity","../widget/loading","../core/model","../widget/scroll","animation","bridge"],function(i,e,s){var t=i("$"),n=i("util"),a=i("activity"),d=i("../widget/loading"),l=i("../core/model"),r=i("../widget/scroll"),c=(i("animation"),i("bridge"));return a.extend({events:{"tap .open_msg":function(i){t(i.target).hasClass("open_msg")&&t(i.target).removeClass("show")},"tap .btn_go":function(){c.openInApp(this.user.OpenUrl)}},swipeRightBackAction:"/",onCreate:function(){var i=this,e=this.$(".main");r.bind(e),this.model=new l.ViewModel(this.$el,{back:"/",title:"我买到的",currentType:0,select:function(e,s){t(e.currentTarget).hasClass("curr")||(t(e.currentTarget).addClass("curr").siblings(".curr").removeClass("curr"),i.loading.setParam(0==s?{status:0,payStatus:0}:1==s?{status:0,payStatus:3}:2==s?{status:18,payStatus:0}:3==s?{status:19,payStatus:0}:{status:8,payStatus:0}).reload(),i.model.set("currentType",s))},open:function(){c.openInApp(i.user.OpenUrl||"http://m.abs.cn")},openPrd:function(e,s){s.data.PRD_DISCONTINUED_FLAG?(i.$open_msg.show(),i.$open_msg[0].clientHeight,i.$open_msg.addClass("show")):s.data.Url&&c.openInApp(s.data.Url)},showExpress:function(i,e){e.set("showExpress",!e.data.showExpress)}}),i.$open_msg=this.$(".open_msg").on(t.fx.transitionEnd,function(e){i.$open_msg.hasClass("show")||i.$open_msg.hide()}),i.loading=new d({url:"/api/order/list",$el:this.$el,checkData:!1,success:function(e){i.model.set("data",e.data)},append:function(e){i.model.get("data").append(e.data)}}),i.user=n.store("user")},onShow:function(){var i=this;i.user=n.store("user"),i.user?i.loading.setParam({UserID:i.user.ID,Auth:i.user.Auth}).load():i.forward("/login?success="+this.route.url+"&from=/")},onDestory:function(){}})});define("template/activity",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main destwrap actwrap"> <div class="destimg"> <img sn-binding="src:data.Pic" /> <div class="destfav" sn-binding="html:data.Favorite"></div> <h1 sn-binding="html:data.Name"></h1> </div> <div class="activity_info"> <div class="act_signup"><b class="act_signup_num" sn-binding="html:data.SignUpQty"></b>报名</div> <div class="act_time"><text sn-binding="html:data.StartTime|date:\'yyyy年MM月dd日 hh:mm\'"></text>~<text sn-binding="html:data.FinishTime|date:\'yyyy年MM月dd日 hh:mm\'"></text></div> <div class="act_address" sn-binding="html:data.Address"></div> </div> <div class="destinfo"> <h2>详情</h2> <div class="destcontent" sn-binding="html:data.Content"></div> </div> <div class="destinfo"> <h2><span class="destcomment js_comment">发表评论</span>评论</h2> <div class="destcontent"> <ul class="quan_list"> <li class="quan_item" sn-repeat="item in comments" sn-binding="data-id:item.ID"> <div class="quan_user"> <img sn-binding="src:item.Avatars" /> <div class="bd"> <h2 sn-binding="html:item.NickName|or:item.Mobile"></h2> <div class="time" sn-binding="html:item.CommentTime|date:\'MM-dd hh:ss\'"></div> </div> </div> <div class="quan_con" sn-binding="html:item.Content"></div> </li> </ul> </div> </div> </div> <footer class="signup_bar"> <b class="btn_signup js_submit">我要报名</b> </footer> ';return __},helpers:{}});return T.template=T.html,T});define("views/activity",["images/style.css","$","util","activity","../widget/loading","../core/model","../core/promise","../widget/scroll","animation"],function(i,e,s){{var n=(i("$"),i("util")),a=i("activity"),d=i("../widget/loading"),l=i("../core/model"),r=i("../core/promise"),o=i("../widget/scroll");i("animation")}return a.extend({events:{"tap .js_submit:not(.disabled)":function(i){this.user?(this.$submit.addClass("disabled"),this.submit.setParam({UserID:this.user.ID,Auth:this.user.Auth}).load()):this.forward("/login?success="+this.route.url+"&from="+this.route.url)},"tap .js_comment":function(){this.forward("/actcomment/"+this.route.data.id)}},onCreate:function(){var i=this;this.promise=new r,this.$main=this.$(".main"),o.bind(this.$main),l.Filter.precent=function(i){return parseFloat(i)+"%"},this.model=new l.ViewModel(this.$el,{title:"活动详情",back:this.route.query.from||"/"}),this.loading=new d({url:"/api/activity/get",params:{id:this.route.data.id},check:!1,checkData:!1,$el:this.$el,$content:this.$main.children(":first-child"),$scroll:this.$main,success:function(e){i.promise.then(function(){i.model.set(e)}),localStorage.setItem("destination",JSON.stringify(e.data))}}),this.loading.load(),this.$submit=this.$el.find(".js_submit"),this.submit=new d({url:"/api/activity/signup",params:{id:this.route.data.id},check:!1,checkData:!1,$el:this.$el,success:function(e){e.success?(sl.tip("报名成功！"),i.model.set("data.SignUpQty",i.model.data.data.SignUpQty+1)):sl.tip(e.msg),i.$submit.removeClass("disabled")}}),this.comments=new d({url:"/api/activity/comment_list",$el:i.$(".quan_list"),success:function(e){i.model.set("comments",e.data)},append:function(e){i.model.get("comments").append(e.data)}}),this.comments.load(),i.onResult("actcomment_success",function(){i.comments.reload()})},onLoad:function(){this.promise.resolve()},onShow:function(){this.user=n.store("user")},onDestory:function(){}})});define("views/register",["images/style.css","$","util","activity","../widget/loading","../core/model","../widget/scroll","animation","util/md5"],function(i,e,s){var n=(i("$"),i("util")),a=i("activity"),d=i("../widget/loading"),l=i("../core/model"),r=i("../widget/scroll"),c=(i("animation"),i("util/md5"));return a.extend({events:{"tap .js_bind:not(.disabled)":function(){var i=this.model.data.mobile,e=this.model.data.password,s=this.model.data.password1,t=this.model.data.smsCode;return i&&n.validateMobile(i)?e!=s?void sl.tip("两次密码输入不一致"):t?void this.loading.setParam({mobile:i,password:c.md5(e),smsCode:t}).load():void sl.tip("请输入验证码"):void sl.tip("请输入正确的手机")},"tap .js_valid:not(.disabled)":function(i){var e=this.model.get("mobile");return e&&n.validateMobile(e)?(this.$valid.addClass("disabled"),this.valid.setParam({mobile:this.model.data.mobile}),void this.valid.load()):void sl.tip("请输入正确的手机")}},validTimeout:function(){var i=this,e=localStorage.getItem("valid_time");if(e&&parseInt(e)>60){if(e=Math.round((new Date(parseInt(e)).getTime()-Date.now())/1e3),0>=e)return;i.$valid.addClass("disabled"),setTimeout(function(){0>=e?(i.$valid.removeClass("disabled"),i.model.set("valid","获取验证码"),localStorage.removeItem("valid_time")):(i.model.set("valid",e+"秒"),e--,setTimeout(arguments.callee,1e3))},1e3)}},onCreate:function(){var i=this,e=this.$(".main");r.bind(e),this.model=new l.ViewModel(this.$el,{title:"注册",valid:"获取验证码",back:this.route.query.from||"/login"}),this.loading=new d({url:"/api/user/register",method:"POST",check:!1,checkData:!1,$el:this.$el,success:function(e){e.success?(localStorage.setItem("user",JSON.stringify(e.data)),i.back(i.route.query.success||"/")):sl.tip(e.msg)},error:function(i){sl.tip(i.msg)}}),this.valid=new d({url:"/api/user/send_sms",method:"POST",params:{mobile:i.model.data.mobile},check:!1,checkData:!1,$el:this.$el,success:function(e){e.success?(localStorage.setItem("valid_time",Date.now()+6e4),i.validTimeout()):sl.tip(e.msg)}}),i.$valid=this.$(".js_valid"),i.validTimeout()},onShow:function(){},onDestory:function(){}})});define("template/register",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div sn-binding="html:title" class="head_title"></div> <div class="head_back" sn-binding="data-back:back"></div> </header> <div class="main"> <div class="login_form"> <ul class="form"> <li><input placeholder="输入手机号" sn-model="mobile" /></li> <li><input placeholder="验证码" sn-model="smsCode" type="text" /> <b class="js_valid btn_middle" sn-binding="html:valid"></b></li> <li><input placeholder="设置密码" sn-model="password" type="password" /></li> <li><input placeholder="再次输入确认密码" sn-model="password1" type="password" /></li> </ul> <div class="login_btn"><b class="btn_large js_bind">确定注册</b> </div> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("template/guide",["util"],function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main guide"> <div class="guide_hd"> 恭喜您成为ABS爱彼此家居会员！<br> 我们为您准备了以下惊喜： </div> <div class="guide_bd"> <ul class="hd"> <li></li> <li>免费礼</li> <li>免费定制</li> <li>免邮费</li> </ul> <ul class="row"> <li> <span>SVIP会员</span> <p>累计金额<br>≥￥50000</p> </li> <li><p>600个月<br>免费礼</p></li> <li></li> <li></li> </ul> <ul class="row"> <li> <span>VIP会员</span> <p>￥10000≦<br>累计金额<br>＜￥50000</p> </li> <li><p>12个月<br>免费礼</p></li> <li></li> <li></li> </ul> <ul class="row"> <li> <span>钻石会员</span> <p>￥5000≦<br>累计金额<br>＜￥10000</p> </li> <li><p>12个月<br>免费礼</p></li> <li></li> <li class="none"></li> </ul> <ul class="row"> <li> <span>金卡会员</span> <p>￥1000≦<br>累计金额<br>＜￥5000</p> </li> <li><p>12个月<br>免费礼</p></li> <li></li> <li class="none"></li> </ul> <ul class="row"> <li> <span>银卡会员</span> <p>￥0＜<br>累计金额<br>＜￥1000</p> </li> <li class="none"><p></p></li> <li></li> <li class="none"></li> </ul> <div class="more"><p>ABS会员专享权益，最终解释权归上海爱彼此家居用品股份有限公司所有。</p> </div> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/guide",["images/style.css","$","util","activity","widget/loading","core/model","widget/scroll","animation"],function(i,e,s){{var a=(i("$"),i("util"),i("activity")),l=(i("widget/loading"),i("core/model")),r=i("widget/scroll");i("animation")}return a.extend({events:{"tap .js_bind:not(.disabled)":function(){}},swipeRightBackAction:"/",onCreate:function(){var e=this.$(".main");r.bind(e),this.model=new l.ViewModel(this.$el,{back:"/",title:"新手指南"})},onShow:function(){},onDestory:function(){}})});