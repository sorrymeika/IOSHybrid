define("views/menu",["images/style.css"],function(e,t,i){var r=(e("$"),e("util")),s=e("activity"),a=e("bridge"),n=e("core/model"),l=e("../widget/scroll");e("../widget/loading");return s.extend({toggleAnim:"menu",className:"menu",events:{tap:function(e){},"tap [data-logout]":function(e){}},swipeLeftBackAction:"/",onCreate:function(){l.bind(this.$(".menu_bd")),a.hasStatusBar&&this.$el.find(".fix_statusbar").addClass("fix_statusbar"),this.model=new n.ViewModel(this.$el,{}),this.onShow()},onShow:function(){var t=r.store("user");t?(this.user=t,this.model.set({memberUrl:"/member",logoutOrLogin:"退出",user:t})):this.model.set({memberUrl:"/login",logoutOrLogin:"登录",user:null})},onDestory:function(){}})});define("views/index",["images/style.css"],function(e,t,s){var i=e("$"),o=e("util"),n=e("activity"),r=e("bridge"),a=e("../widget/loading"),c=(e("../widget/slider"),e("../core/model")),u=e("../widget/scroll"),d=(e("../widget/barcode"),e("../util/barcode")),p=e("animation"),h=[1e3,4e3,5e3,45e3],g=function(e){for(var t=0,s=0;s<h.length;s++){if(e<=h[s]){t+=25*e/h[s];break}t+=25,e-=h[s]}return t};return n.extend({events:{tap:function(e){e.target==this.el&&this.back("/")},"tap .open_msg":function(e){i(e.target).hasClass("open_msg")&&i(e.target).removeClass("show")},"tap .head_menu":function(e){this.forward("/menu")},"tap .js_comment_list [data-id]":function(e){},"tap .footer li":function(e){var t=i(e.currentTarget),s=t.index();1==s?r.open(this.user.OpenUrl||"http://m.abs.cn"):t.hasClass("curr")||(t.addClass("curr").siblings(".curr").removeClass("curr"),this.$main.eq(s).show().siblings(".main").hide(),2!=s||this.model.data.baiduMap||(this.model.set("baiduMap",'<iframe class="js_baidu_map" src="'+r.url("/baiduMap.html")+'" frameborder="0" ></iframe>'),this.$baiduMap=this.$(".js_baidu_map").css({width:window.innerWidth,height:window.innerHeight-47-44-(o.isInApp?20:0)})))}},swipeRightForwardAction:"/menu",className:"home",titles:["欢迎来到ABS会员俱乐部","马上购物","附件门店","我"],onCreate:function(){var e=this;i.get(r.url("/api/settings/update?version="+sl.appVersion),function(t){t.success&&t.updateUrl&&e.confirm(t.text,function(){r.open(t.updateUrl,{target:"browser"})})},"json"),this.model=new c.ViewModel(this.$el,{menu:"head_menu",titleClass:"head_title",title:"ABS + CLUB",isLogin:!!o.store("user"),msg:0,open:function(){r.open(e.user.OpenUrl||"http://m.abs.cn")},openUrl:function(e,t){r.open(t||"http://m.abs.cn")}});var t=this.$main=this.$(".main");u.bind(t.filter(".js_usescroll"),{useScroll:!0}),u.bind(t.filter(":not(.js_usescroll)")),this.$points=this.$(".home_points"),this.$cursor=this.$(".home_points_cursor"),e.$open_msg=this.$(".open_msg").on(i.fx.transitionEnd,function(t){e.$open_msg.hasClass("show")||e.$open_msg.hide()}),u.bind(e.$open_msg.find(".msg_bd")),this.userLoading=new a({url:"/api/user/get",check:!1,checkData:!1,$el:this.$el,success:function(t){i.extend(e.user,t.data),o.store("user",e.user),e.model.set({user:e.user}),e.showPoints(),e.getUnreadMsg(),t.vdpMessage&&(e.$open_msg.show(),e.$open_msg[0].clientHeight,e.$open_msg.addClass("show"),e.model.set({message:t.vdpMessage}))}}),this.adLoading=new a({url:"/api/settings/ad_list?name=index1",check:!1,checkData:!1,$el:this.$el.find(".home_ad"),success:function(t){e.model.set({ads:t.data});var s=e.$(".home_ad > li");s.each(function(e){var t=this;setTimeout(function(){t.className="toggle"},100*(e+1))})}});var s=this.$(".launch img"),n=this.$(".home_mask").on(i.fx.transitionEnd,function(e){if(n.hasClass("toggle")){n.removeClass("toggle");var t=s.filter(":not(.launch_hide)").addClass("launch_hide");s.eq(t.index()+1==s.length?0:t.index()+1).removeClass("launch_hide")}});setTimeout(function(){n.addClass("toggle"),setTimeout(arguments.callee,3200)},3200)},setRainbow:function(){var n,r,l,e=this,t=Math.round(this.user.Amount),s=g(t),i=s/50*117-117,c=["银卡会员","金卡会员","钻石会员","VIP会员","SVIP会员","无敌会员"];e.model.set("vip",t<(l=1e3)?(n=0,r=1e3-t,c[1]):t<(l=5e3)?(n=1,r=5e3-t,c[2]):t<(l=1e4)?(n=2,r=1e4-t,c[3]):t<(l=5e4)?(n=3,r=5e4-t,c[4]):(n=4,r="0",c[5])),this.$(".rainbow_vip :nth-child("+(n+1)+")").addClass("curr"),e.model.set("nextLevel","+"+r),e.model.set("currentLevel",c[n]),e.model.set("levelAmounts",l),e.model.set("cardAmounts","("+t+(t>5e4?"":"/"+l)+")"),t!=e.model.data.point&&(e.model.set("point",t),p.animate(function(s){var n=p.step(-117,i,s),r=Math.round(p.step(0,t,s)),a=o.circlePoint(0,0,91,90-n);a.x>0?0==i?a.x=0:55>i?(a.x-=4,a.y+=2):80>i?a.x-=7:(a.x-=9,a.y+=2):a.y+=2,e.model.set("Point",r),e.$cursor.css({"-webkit-transform":"rotate("+i+"deg)",top:91-a.y,left:91+a.x})},800,"ease-out"),s>50&&this.$points.eq(0).animate({rotate:"0deg"},800,"ease-out"),this.$points.eq(1).animate({rotate:i+"deg"},800,"ease-out"))},getUnreadMsg:function(){var e=this;i.get(r.url("/api/user/get_unread_msg_count"),{UserID:e.user.ID,Auth:e.user.Auth},function(t){t.success&&e.model.set("msg",t.count)},"json")},onShow:function(){var e=this;e.user=o.store("user");var t=!!e.user;e.model.set("isLogin",t),t&&(e.showPoints(),e.model.set("barcode",d.code93(e.user.Mobile).replace(/0/g,"<em></em>").replace(/1/g,"<i></i>")).set("user",e.user),!this.userLoaded&&(this.userLoaded=!0)?(this.userLoading.setParam({UserID:e.user.ID,Auth:e.user.Auth,IMEI:"CAN_NOT_GET"}).load(),this.adLoading.load()):this.getUnreadMsg())},showPoints:function(){this.setRainbow(this.user.Amount),this.$(".point_tip").addClass("show")},onPause:function(){},onDestory:function(){}})});define("template/menu",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<div class="menu_bd"> <div class="menu_user" sn-binding="data-back:memberUrl"> <div class="menu_username" sn-binding="display:user"> <h1> <text sn-binding="html:user.UserName|or:user.Mobile"></text> <span>编辑信息</span> </h1> <h2 sn-binding="html:user.BirthDay|date:\'yyyy/MM/dd\'"></h2> </div> <div class="menu_username" sn-binding="display:user|isFalse" style="display:none"> <div class="btn_mid">登录</div> </div> </div> <ul class="menu_list menu_my"> <li data-forward="/month">我的月礼</li> <li data-forward="/mycard">我的卡券</li> <li data-forward="/mypoint">我的积分</li> <li data-forward="/myorder">我买到的</li> </ul> <ul class="menu_list menu_service"> <li data-forward="/guide">新手指南</li> <li><a href="tel:4008205077">联系客服</a></li> </ul> <ul class="menu_list menu_settings"> <li data-forward="/settings">设置</li> </ul> </div>';return __},helpers:{}});return T.template=T.html,T});define("template/about",function(require){var util=require("util"),T={html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main"> <div class="aboutus"> 邻师是一个针对0～18岁学生（家长）和教师的教育资源整合平台，我们专门帮助小微培训机构，教师工作室及教师个人进行品牌塑造和市场推广，我们希望让老师能够招到更多的优质学生，让学生找到更合适自己的老师。 <img src="'+util.encodeHTML(webresource("images/aboutus.jpg"))+'" /> <div class="aboutus_ver">发现身边好老师</div> </div> </div> ';return __},helpers:{}};return T.template=T.html,T});define("views/about",["images/style.css"],function(e,t,i){var n=(e("$"),e("util"),e("activity")),o=(e("../widget/extend/loading"),e("../core/model")),l=e("../widget/scroll");e("animation");return n.extend({events:{},swipeRightBackAction:"/settings",onCreate:function(){var t=this.$(".main");l.bind(t),this.model=new o.ViewModel(this.$el,{back:"/settings",title:"关于我们"})},onShow:function(){},onDestory:function(){}})});define("views/member",["images/style.css"],function(e,t,i){var s=e("$"),a=e("util"),n=e("activity"),r=e("core/model"),l=(e("../widget/scroll"),e("bridge")),u=e("../widget/loading"),d=e("../widget/selector");return n.extend({events:{"tap .radio":function(e){var t=s(e.currentTarget),i=e.currentTarget.getAttribute("value");this.model.set(t.attr("sn-model"),i)}},onCreate:function(){var e=this;e.swipeRightBackAction=this.route.query.from||"/",this.model=new r.ViewModel(this.$el,{title:"个人信息",back:e.swipeRightBackAction,showCity:function(){var i=a.indexOf(e.provinceList,function(t){return t.PRV_ID==e.model.data.user.ProvID});-1!=i&&(e.city.eq(0).index(i),t(e.model.data.user.ProvID)),e.city.show()},submit:function(){this.set("submiting",!0);var t=this.data.user;e.update.setParam({ID:t.ID,Auth:t.Auth,UserName:t.UserName,Gender:t.Gender,BirthDay:t.BirthDay&&a.formatDate(t.BirthDay),ChildBirthDay:t.ChildBirthDay&&a.formatDate(t.ChildBirthDay),CityID:t.CityID,FamilySize:t.FamilySize,HasChild:t.HasChild}).load()}}),this.update=new u({url:"/api/user/update",check:!1,checkData:!1,$el:this.$el,success:function(t){t.success?(a.store("user",e.model.data.user),sl.tip("修改成功")):sl.tip(t.msg),e.model.set("submiting",!1)}}),this.city=new d({options:[{template:"<li><%=PRV_DESC%></li>",data:[],onChange:function(e,i,s){t(s.PRV_ID)}},{template:"<li><%=CTY_DESC%></li>",data:[]}],complete:function(t){e.model.set("user.City",t[1].CTY_DESC),e.model.set("user.CityID",t[1].CTY_ID),e.model.set("user.ProvID",t[1].CTY_PRV_ID)}});var t=function(t){var i=a.find(e.cityList,function(e){return e.CTY_PRV_ID==t});if(i.unshift({CTY_PRV_ID:t,CTY_ID:0,CTY_DESC:"请选择"}),e.city.eq(1).set(i),e.model.data.user){var s=a.indexOf(i,function(t){return t.CTY_ID==e.model.data.user.CityID});-1!=s&&e.city.eq(1).index(s)}};s.get(l.url("/api/user/get_city"),function(i){i.province.unshift({PRV_ID:0,PRV_DESC:"请选择"}),e.city.eq(0).set(i.province),e.provinceList=i.province,e.cityList=i.data,t(i.province[0].PRV_ID)},"json")},onShow:function(){var e=this,t=a.store("user");t?(e.user=t,this.loading=new u({url:"/api/user/get",check:!1,checkData:!1,params:{UserID:t.ID,Auth:t.Auth},$el:this.$el,success:function(i){e.user=t=s.extend(t,i.data),a.store("user",t),e.model.set({user:t,"NickName.input":t.NickName,"Address.input":t.Address})}}),this.loading.load()):this.forward("/login")},onDestory:function(){}})});define("template/member",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main scrollview"> <div class="member"> <dl class="member_info"> <dt>登录名</dt> <dd><p sn-binding="html:user.Mobile"></p></dd> <dt>姓名</dt> <dd><input sn-binding="value:user.UserName" sn-model="user.UserName" /></dd> <dt>性别：</dt> <dd> <span class="radio" sn-model="user.Gender" value="1" sn-binding="class:user.Gender|case:\'1\':\'checked\':\'\'">男</span> <span class="radio" sn-model="user.Gender" value="2" sn-binding="class:user.Gender|case:\'2\':\'checked\':\'\'">女</span> </dd> <dt>生日</dt> <dd><input type="text" sn-binding="value:user.BirthDay|date:\'yyyy/MM/dd\'" sn-model="user.BirthDay" /></dd> <dt>所在地</dt> <dd sn-on="tap:showCity"><p sn-binding="html:user.City"></p></dd> <dt>家庭人数</dt> <dd><input sn-binding="value:user.FamilySize" sn-model="user.FamilySize" /></dd> <dt>是否有小孩：</dt> <dd> <span class="radio" sn-model="user.HasChild" value="1" sn-binding="class:user.HasChild|equal:true:\'checked\':\'\'">是</span> <span class="radio" sn-model="user.HasChild" value="0" sn-binding="class:user.HasChild|equal:false:\'checked\':\'\'">否</span> </dd> <dt>小孩生日</dt> <dd><input type="text" sn-binding="value:user.ChildBirthDay" sn-model="user.ChildBirthDay" /></dd> </dl> <div class="member_bar"> <b class="btn_mid" sn-on="tap:submit" sn-binding="class:submiting|equal:true:\'disabled\':\'\'">修改</b> <b class="btn_cancel">取消</b> </div> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("views/settings",["images/style.css"],function(e,t,i){var a=(e("$"),e("util")),n=e("activity"),d=(e("../widget/loading"),e("../core/model")),l=e("../widget/scroll");e("animation");return n.extend({events:{"tap .js_bind:not(.disabled)":function(){}},swipeRightBackAction:"/",onCreate:function(){var e=this,t=this.$(".main");l.bind(t);var i=a.store("user");this.model=new d.ViewModel(this.$el,{back:"/",title:"设置",user:i,logout:function(){localStorage.getItem("user")?(a.store("user",null),e.back("/")):e.forward("/login")}})},onShow:function(){},onDestory:function(){}})});define("template/login",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div sn-binding="html:title" class="head_title"></div> <div class="head_back" sn-binding="data-back:back"></div> </header> <div class="main"> <div class="login_form"> <h1 class="login_hd">注册/登录</h1> <ul class="form"> <li class="form_mobile"><input placeholder="请输入您的手机号码" sn-model="mobile" /></li> <li><input placeholder="请输入短信验证码" sn-model="smsCode" type="text" /><b class="js_valid btn_middle" sn-binding="html:valid"></b></li> </ul> <div class="login_btn"><b class="btn_large js_login">手机号登录</b> </div> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("template/settings",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='\ufeff<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main settings"> <div class="hello"> <div class="name" sn-binding="html:user.UserName|or:\'亲爱的用户\'"></div> <div class="text">你好！</div> </div> <ul class="con"> <li data-forward="/member?from=/settings">账户信息</li> <li>隐私政策</li> </ul> <div class="ft"> <b class="btn_large" sn-on="tap:logout" sn-binding="html:user|equal:null:\'立即登录\':\'退出登录\'"></b> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/login",["images/style.css"],function(e,t,i){var s=e("$"),a=e("util"),n=e("activity"),l=e("../widget/loading"),d=e("../core/model"),r=e("../widget/scroll");e("animation");return n.extend({events:{"tap .js_login:not(.disabled)":function(){var e=this.model.get("mobile"),t=this.model.get("smsCode");return e&&a.validateMobile(e)?t?void this.loading.setParam({mobile:e,smsCode:t}).load():void sl.tip("请输入密码"):void sl.tip("请输入正确的手机")},"tap .js_valid:not(.disabled)":function(e){var t=this.model.get("mobile");return t&&a.validateMobile(t)?(this.$valid.addClass("disabled"),this.valid.setParam({mobile:this.model.data.mobile}),void this.valid.load()):void sl.tip("请输入正确的手机")}},swipeRightBackAction:"/",validTimeout:function(){var e=this,t=localStorage.getItem("valid_time");if(t&&parseInt(t)>60){if(t=Math.round((new Date(parseInt(t)).getTime()-Date.now())/1e3),0>=t)return;e.$valid.addClass("disabled"),setTimeout(function(){0>=t?(e.$valid.removeClass("disabled"),e.model.set("valid","获取验证码"),localStorage.removeItem("valid_time")):(e.model.set("valid",t+"秒后再次获取"),t--,setTimeout(arguments.callee,1e3))},1e3)}},onCreate:function(){var e=this,t=this.$(".main");r.bind(t),this.model=new d.ViewModel(this.$el,{title:"快速登录 / 注册",valid:"获取验证码",back:this.route.query.from||"/"}),this.getUser=new l({url:"/api/user/get",check:!1,checkData:!1,$el:this.$el,success:function(){}}),this.loading=new l({url:"/api/user/login",method:"POST",check:!1,checkData:!1,$el:this.$el,success:function(t){t.success?(a.store("user",t.data),e.getUser.setParam({UserID:t.data.UserID,Auth:t.data.Auth}).load(function(i,n){n&&a.store("user",s.extend(t.data,n.data)),e.back(e.route.query.success||"/")})):sl.tip(t.msg)},error:function(e){sl.tip(e.msg)}}),this.valid=new l({url:"/api/user/send_sms",method:"POST",params:{mobile:e.model.data.mobile},check:!1,checkData:!1,$el:this.$el,success:function(t){t.success?(localStorage.setItem("valid_time",Date.now()+6e4),e.validTimeout()):sl.tip(t.msg)},error:function(t){sl.tip(t.msg),e.$valid.removeClass("disabled"),this.hideLoading()}}),e.$valid=this.$(".js_valid"),e.validTimeout()},onShow:function(){},onDestory:function(){}})});define("template/index",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='<header> <div sn-binding="class:menu"></div> <div sn-binding="html:title,class:titleClass"></div> <div class="head_msg" data-forward="/messages"> <i sn-binding="html:msg,display:msg|equal:0|not"></i> </div> </header> <div sn-binding="display:isLogin|not"> <div class="home_mask"></div> <div class="home_text" data-forward="/login"> <h1></h1> <h2>让回家的灯，为爱亮起来。</h2> <h3>开启时尚居家之旅</h3> <h4>LIFE STARTS HERE</h4> </div> <div class="launch"> <img src="images/launch0.jpg" /> <img src="images/launch1.jpg" class="launch_hide" /> <img src="images/launch2.jpg" class="launch_hide" /> </div> </div> <div sn-binding="display:isLogin"> <div class="main js_usescroll" data-index="0" sn-binding="class:isLogin|equal:true:\'\':\'isnotlogin\'"> <div class="home_bd"> <div class="home_vip"> <div class="rainbow"> <ul class="rainbow_points"> <li>0</li> <li>1000</li> <li>5000</li> <li>10000</li> <li>50000</li> </ul> <ul class="rainbow_vip"> <li>银卡</li> <li>金卡</li> <li>钻石</li> <li>VIP</li> <li>SVIP</li> </ul> <div class="rainbow_bd"> <div class="point" sn-binding="html:Point|round"></div> <div class="desc" sn-binding="html:currentLevel"></div> <div class="point_tip"> <div sn-binding="display:nextLevel|equal:0" class="max"> <p>活力值爆棚啦</p> <p>继续努力哦</p> </div> <div sn-binding="display:nextLevel|equal:0|not"> <span sn-binding="html:nextLevel"></span><b>活力值</b> <p>即可享有<em sn-binding="html:vip"></em>特权</p> </div> </div> </div> </div> <div class="home_points_bg"> <div class="home_points"></div> <div class="home_points"></div> <div class="home_points_cursor"></div> </div> </div> <ul class="home_ad"> <li sn-repeat="item in ads"> <img sn-binding="src:item.Src" sn-on="tap:openUrl:item.Url" /> </li> </ul> </div> </div> <div class="main" style="display:none" data-index="1"> </div> <div class="main" style="display:none" data-index="2"> <div class="baiduMap" sn-binding="html:baiduMap"> </div> </div> <div class="main home_my" style="display:none" data-index="3"> <div class="my"> <div class="card"> <div class="level"> <span sn-binding="html:currentLevel"></span> <span sn-binding="html:cardAmounts"></span> </div> <div class="point" sn-binding="html:id|format:\'ID:{0}\'"></div> <div class="barcode" sn-binding="html:barcode"> </div> <div class="mobile" sn-binding="html:user.Mobile"></div> </div> <ul class="myabs"> <li data-forward="/month"> <b>我的月礼</b> <span sn-binding="display:user.FreeMonths|isTrue" style="display:none">您当前享有<em sn-binding="html:user.FreeMonths|concat:\'个月\'"></em>会员礼免费领特权。</span> <span sn-binding="display:user.FreeMonths|isFalse">继续努力，马上就可以获得免费领取特权了。</span> </li> <li data-forward="/mycard"> <b>我的卡券</b> <span>您现在拥有优惠券<em sn-binding="html:user.CouponsCount"></em>张。</span> </li> <li data-forward="/mypoint"> <b>我的积分</b> <span>您当前积分为<em sn-binding="html:user.Points"></em>。</span> </li> <li data-forward="/myorder"> <b>我买到的</b> <span sn-binding="display:user.OrderCount|isTrue" style="display:none">您目前在ABS共完成<em sn-binding="html:user.OrderCount"></em>次购物。</span> <span sn-binding="display:user.OrderCount|isFalse"> 您还未购买过商品，立即开启您的购物之旅。</span> </li> </ul> </div> </div> </div> <ul class="footer" sn-binding="display:isLogin"> <li class="curr">首页</li> <li>马上购物</li> <li>附近门店</li> <li>我</li> </ul> <div class="open_msg" style="display:none"> <div class="msg_bd" sn-binding="html:message"></div> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/month",["images/style.css"],function(e,i,s){var a=(e("$"),e("util")),n=e("activity"),l=e("../widget/loading"),d=e("../core/model"),r=e("../core/promise"),o=e("../widget/scroll");e("animation");return n.extend({events:{"tap .js_comment":function(){this.forward("/destcomment/"+this.route.data.id)}},swipeRightBackAction:"/",onCreate:function(){var e=this;this.promise=new r,this.$main=this.$(".main"),o.bind(this.$main),this.model=new d.ViewModel(this.$el,{title:"我的月礼",back:this.route.query.from||"/",user:a.store("user"),open:function(){bridge.open(e.user.OpenUrl||"http://m.abs.cn")}}),this.loading=new l({url:"/api/user/get_month_free",params:{id:this.route.data.id},check:!1,checkData:!1,$el:this.$el,$content:this.$main.children(":first-child"),$scroll:this.$main,success:function(i){e.model.set({currentMonth:i.currentMonth,data:i.data})}})},onShow:function(){var e=this;e.user=this.model.data.user||a.store("user"),e.user?(e.model.set({user:e.user}),!e.isLoad&&(e.isLoad=!0)&&e.loading.setParam({UserID:e.user.ID,Auth:e.user.Auth}).load()):e.forward("/login?success="+this.route.url+"&from=/")},onDestory:function(){}})});define("views/mycard",["images/style.css"],function(e,i,s){var n=(e("$"),e("util")),a=e("activity"),l=e("../widget/loading"),d=e("../core/model"),r=e("../widget/scroll"),u=(e("animation"),e("bridge")),c=function(e){if(!e.eq(0).hasClass("show")&&e.length){var i=e.length,s=i-1;e.parent().css({height:100*i}),e.each(function(e,i){i.style.zIndex=e}),setTimeout(function(){var i=arguments.callee,t=e.eq(s);t[0].clientHeight,t.addClass("show"),setTimeout(function(e){return function(){t.animate({opacity:1,translate:"0px,"+100*e+"px"},450*e,"ease-out"),s--,s>=0&&i()}}(s),300)},200)}};return a.extend({events:{},swipeRightBackAction:"/",onCreate:function(){var e=this,i=this.$(".main");r.bind(i),d.Filter.cardClass=function(e,i){return 4==i?"free":2==i?"price10":1==i?"price50":""},this.model=new d.ViewModel(this.$el,{back:"/",title:"我的卡券",isOverdue:!1,open:function(){u.open(e.user.OpenUrl||"http://m.abs.cn")}}),e.loading=new l({url:"/api/user/voucher_list",params:{status:1},$el:this.$el,check:!1,checkData:!1,success:function(i){if(i.closeNumber&&alert("您有"+i.closeNumber+"张优惠券马上就要过期啦，\r尽快使用哦"),i&&i.data&&0!=i.data.length){var s=n.find(i.data,function(e){return!e.IsOverdue});s.sort(function(e,i){return e.CSV_END_DT>i.CSV_END_DT?1:e.CSV_END_DT==i.CSV_END_DT?0:-1}),e.model.set("data",s);var t=n.find(i.data,function(e){return e.IsOverdue});t.sort(function(e,i){return e.CSV_END_DT>i.CSV_END_DT?-1:e.CSV_END_DT==i.CSV_END_DT?0:1}),e.model.set("data1",t);var a=e.$(".js_not_overdue").children("li");c(a)}else e.model.set("data",[]),e.model.set("data1",[])}}),e.model.on("change:isOverdue",function(){if(e.model.data.isOverdue){var i=e.$(".js_overdue").children("li");c(i)}}),e.user=n.store("user")},onShow:function(){var e=this;e.user=n.store("user"),e.user?!e.isLoad&&(e.isLoad=!0)&&e.loading.setParam({UserID:e.user.ID,Auth:e.user.Auth}).load():e.forward("/login?success="+this.route.url+"&from=/")},onDestory:function(){}})});define("template/mycard",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='\ufeff<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <ul class="mycard_hd"> <li sn-binding="class:isOverdue|equal:false:\'curr\':\'\'" sn-on="tap:isOverdue=false">待使用</li> <li sn-binding="class:isOverdue|equal:false:\'\':\'curr\'" sn-on="tap:isOverdue=true">已过期</li> </ul> <div class="main mycard"> <ul class="mycard_con js_not_overdue" sn-binding="display:isOverdue|not"> <!-- <li class="free"> <div class="name">免邮券</div> <div class="time"><div class="hd">有效期</div><div class="con">2015/07/30</div></div> </li>--> <li sn-repeat="item in data" sn-binding="class:item.VCA_DEDUCT_AMOUNT|cardClass:item.VCA_VCT_ID"> <div class="price" sn-binding="html:item.VCA_DEDUCT_AMOUNT|currency,display:item.VCA_VCT_ID|equal:4|not"></div> <div class="name" sn-binding="html:item.VCA_NAME"><!--单笔订单满300可用--></div> <div class="time"><div class="hd">有效期</div><div class="con" sn-binding="html:item.CSV_END_DT|date:\'yyyy/MM/dd\'"></div></div> </li> </ul> <ul class="mycard_con js_overdue" sn-binding="display:isOverdue"> <li class="dis" sn-repeat="item in data1" sn-binding="class:item.VCA_VCT_ID|equal:4:\'free\':\'\'"> <div class="price" sn-binding="html:item.VCA_DEDUCT_AMOUNT|currency,display:item.VCA_VCT_ID|equal:4|not"></div> <div class="name" sn-binding="html:item.VCA_NAME"><!--单笔订单满300可用--></div> <div class="time"><div class="hd">有效期</div><div class="con" sn-binding="html:item.CSV_END_DT|date:\'yyyy/MM/dd\'"></div></div> </li> </ul> <div class="my_nodata" sn-binding="display:data|eval:\'$1?!$2.length:!$0.length\':isOverdue:data1" style="display:none"> <div class="icon"></div> <div class="text">您目前还没有卡券哦</div> <div class="btn" sn-on="tap:open">去逛逛吧</div> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("template/month",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='\ufeff<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main mymonth"> <div sn-binding="display:user.FreeMonths|not|equal:0"> <div class="month_present"> <img sn-binding="src:currentMonth.FRE_PIC1" /> </div> <div class="month_notice"> 不要忘记啦！您还有<em sn-binding="html:user.FreeMonths"></em>个月的会员礼可以领取哟！ </div> <ul class="month"> <li sn-repeat="item in data" sn-binding="class:item|eval:\'$0.Overdue&&$0.CanGet?\\\'overdue curr\\\':$0.Overdue?\\\'overdue\\\':$0.CanGet?\\\'curr\\\':\\\'\\\'\'"> <i class="flag" sn-binding="html:item.Year|concat:\'年\',display:item.Year" style="display:none">2015年</i> <img sn-binding="src:item.FRE_PIC1,display:item.FRE_PIC1" /> <span sn-binding="html:item|eval:\'$0.Overdue?\\\'过期\\\':$0.LPF_PUR_ID?\\\'已领\\\':($0.Month+\\\'月\\\')\'"></span> <em sn-binding="display:item.CanGet" style="display:none">立即领取</em> </li> </ul> </div> <div class="my_nodata" sn-binding="display:user.FreeMonths|equal:0" style="display:none"> <div class="icon"></div> <div class="text">您目前还没有免费领取特权哦！</div> <div class="btn" sn-on="tap:open">去逛逛吧</div> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("template/messages",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='\ufeff<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main message_center"> <div class="message_card" sn-repeat="item in data"> <div class="hd"> <h2 sn-binding="html:item.MSG_TITLE"></h2> <h3 sn-binding="html:item.MSG_DT|date:\'yyyy.MM.dd\'"></h3> </div> <div class="bd" sn-binding="html:item.MSG_CONTENT"></div> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/messages",["images/style.css"],function(e,i,s){var n=(e("$"),e("util")),a=e("activity"),d=e("../widget/loading"),l=e("../core/model"),r=e("../widget/scroll");e("animation");return a.extend({events:{},onCreate:function(){var e=this,i=this.$(".main");r.bind(i),this.model=new l.ViewModel(this.$el,{back:"/",title:"消息中心"}),this.loading=new d({url:"/api/user/get_msg",$el:this.$el,checkData:!1,success:function(i){i.data||this.showError("暂无消息"),e.model.set("data",i.data)},append:function(i){e.model.get("data").append(i.data)}})},onShow:function(){var e=this;e.user=n.store("user"),e.user?e.loading.setParam({UserID:e.user.ID,Auth:e.user.Auth}).load():e.forward("/login?success="+this.route.url+"&from=/")},onDestory:function(){}})});define("template/mypoint",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='\ufeff<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main mypoint"> <div sn-binding="display:points|equal:0|not"> <div class="curr">当前积分：<b sn-binding="html:points"></b></div> <div class="notice">*您的积分可以直接抵扣现金使用。<span>（100积分＝1元）</span></div> <div class="hd">积分记录</div> <ul class="mypoint_list"> <li sn-repeat="item in data"> <p class="from" sn-binding="html:item.HPT_PIT_ID|equal:1:item.CNL_DESC:item.POT_DESC"></p> <p class="date" sn-binding="html:item.HPT_DT|date:\'yyyy.MM.dd\'"></p> <p class="points" sn-binding="html:item.HPT_POINT_AMOUNT|round|eval:\'$0>0?\\\'+\\\'+$0:$0\',class:item.HPT_POINT_AMOUNT|lt:0|equal:true:\'minus\':\'\'"></p> </li> </ul> </div> <div class="my_nodata" sn-binding="display:points|equal:0" style="display:none"> <div class="icon"></div> <div class="text">您目前还没有积分记录哦</div> <div class="btn" sn-on="tap:open">去逛逛吧</div> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/mypoint",["images/style.css"],function(e,i,s){var n=(e("$"),e("util")),a=e("activity"),d=e("../widget/loading"),l=e("../core/model"),r=e("../widget/scroll");e("animation");return a.extend({events:{},swipeRightBackAction:"/",onCreate:function(){var e=this,i=this.$(".main");r.bind(i),this.model=new l.ViewModel(this.$el,{back:"/",title:"我的积分",open:function(){bridge.open(e.user.OpenUrl||"http://m.abs.cn")}})},onShow:function(){var e=this,e=this,i=n.store("user");i?(e.user=i,this.loading=new d({url:"/api/user/get_points",check:!1,checkData:!1,params:{UserID:i.ID,Auth:i.Auth},$el:this.$el,success:function(i){e.model.set(i)}}),this.loading.load()):this.forward("/login")},onDestory:function(){}})});define("template/myorder",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='\ufeff<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <ul class="myorder_hd" sn-binding="display:data|eval:\'$0&&$0.length||($1!=0)\':\'currentType\'"> <li class="curr" sn-on="tap:select:0">全部</li> <li sn-on="tap:select:1">待付款</li> <li sn-on="tap:select:2">待发货</li> <li sn-on="tap:select:3">配送中</li> <li sn-on="tap:select:4">已完成</li> </ul> <div class="main myorder"> <ul class="con" sn-binding="display:data"> <li sn-repeat="item in data" sn-binding="class:item.CNL_CLT_ID|format:\'type{0}\'"> <div class="hd"><b class="from" sn-binding="html:item.CNL_DESC"></b><span class="status" sn-binding="html:item.PUS_DESC"></span></div> <div class="info"> <span sn-binding="html:item.PUR_CODE|format:\'订单号：{0}\'"></span> <span sn-binding="html:item.PUR_DT|date"></span> </div> <div class="bd" sn-repeat="prd in item.Children" sn-on="tap:openPrd:prd.Url"> <img sn-binding="src:prd.WPP_LIST_PIC" /> <div class="con"> <h2 sn-binding="html:prd.PRD_NAME"></h2> <h3>颜色：<span sn-binding="html:prd.PRD_COLOR"></span></h3> <h4>尺寸：<span sn-binding="html:prd.PRD_SPEC"></span></h4> </div> <p class="priceinfo"> <span class="price" sn-binding="html:prd.PRD_MEMBER_PRICE|currency:\'￥\'"></span> <span class="qty" sn-binding="html:prd.LPK_QTY|format:\'x{0}\'"></span> </p> </div> <div class="ft"> 总价：<span sn-binding="html:item.PUR_AMOUNT|currency:\'￥\'"></span> <b class="btn_sml" sn-binding="display:item.XPU_EXPRESS_CODE|equal:null|not">查看物流</b> </div> </li> </ul> <div class="my_nodata" sn-binding="display:data|eval:\'$1==0&&(!$0||!$0.length)\':currentType" style="display:none"> <div class="icon"></div> <div class="text">您目前还没有购物记录哦</div> <div class="btn" sn-on="tap:open">去逛逛吧</div> </div> <div class="my_nodata" sn-binding="display:data|eval:\'$1!=0&&(!$0||!$0.length)\':currentType" style="display:none"> <div class="icon"></div> <div class="text">您还没有相关的订单</div> <div class="btn" sn-on="tap:open">去逛逛吧</div> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/myorder",["images/style.css"],function(i,e,s){var t=i("$"),n=i("util"),a=i("activity"),d=i("../widget/loading"),l=i("../core/model"),r=i("../widget/scroll"),c=(i("animation"),i("bridge"));return a.extend({events:{},swipeRightBackAction:"/",onCreate:function(){var i=this,e=this.$(".main");r.bind(e),this.model=new l.ViewModel(this.$el,{back:"/",title:"我买到的",currentType:0,select:function(e,s){t(e.currentTarget).hasClass("curr")||(t(e.currentTarget).addClass("curr").siblings(".curr").removeClass("curr"),i.loading.setParam(0==s?{status:0,payStatus:0}:1==s?{status:0,payStatus:3}:2==s?{status:18,payStatus:0}:3==s?{status:19,payStatus:0}:{status:8,payStatus:0}).reload(),i.model.set("currentType",s))},open:function(){c.open(i.user.OpenUrl||"http://m.abs.cn")},openPrd:function(i,e){e&&c.open(e)}}),i.loading=new d({url:"/api/order/list",$el:this.$el,checkData:!1,success:function(e){i.model.set("data",e.data)},append:function(e){i.model.get("data").append(e.data)}}),i.user=n.store("user")},onShow:function(){var i=this;i.user=n.store("user"),i.user?i.loading.setParam({UserID:i.user.ID,Auth:i.user.Auth}).load():i.forward("/login?success="+this.route.url+"&from=/")},onDestory:function(){}})});define("template/activity",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='\ufeff<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main destwrap actwrap"> <div class="destimg"> <img sn-binding="src:data.Pic" /> <div class="destfav" sn-binding="html:data.Favorite"></div> <h1 sn-binding="html:data.Name"></h1> </div> <div class="activity_info"> <div class="act_signup"><b class="act_signup_num" sn-binding="html:data.SignUpQty"></b>报名</div> <div class="act_time"><text sn-binding="html:data.StartTime|date:\'yyyy年MM月dd日 hh:mm\'"></text>~<text sn-binding="html:data.FinishTime|date:\'yyyy年MM月dd日 hh:mm\'"></text></div> <div class="act_address" sn-binding="html:data.Address"></div> </div> <div class="destinfo"> <h2>详情</h2> <div class="destcontent" sn-binding="html:data.Content"></div> </div> <div class="destinfo"> <h2><span class="destcomment js_comment">发表评论</span>评论</h2> <div class="destcontent"> <ul class="quan_list"> <li class="quan_item" sn-repeat="item in comments" sn-binding="data-id:item.ID"> <div class="quan_user"> <img sn-binding="src:item.Avatars" /> <div class="bd"> <h2 sn-binding="html:item.NickName|or:item.Mobile"></h2> <div class="time" sn-binding="html:item.CommentTime|date:\'MM-dd hh:ss\'"></div> </div> </div> <div class="quan_con" sn-binding="html:item.Content"></div> </li> </ul> </div> </div> </div> <footer class="signup_bar"> <b class="btn_signup js_submit">我要报名</b> </footer> ';return __},helpers:{}});return T.template=T.html,T});define("views/activity",["images/style.css"],function(i,e,s){var n=(i("$"),i("util")),a=i("activity"),d=i("../widget/loading"),l=i("../core/model"),r=i("../core/promise"),o=i("../widget/scroll");i("animation");return a.extend({events:{"tap .js_submit:not(.disabled)":function(i){this.user?(this.$submit.addClass("disabled"),this.submit.setParam({UserID:this.user.ID,Auth:this.user.Auth}).load()):this.forward("/login?success="+this.route.url+"&from="+this.route.url)},"tap .js_comment":function(){this.forward("/actcomment/"+this.route.data.id)}},onCreate:function(){var i=this;this.promise=new r,this.$main=this.$(".main"),o.bind(this.$main),l.Filter.precent=function(i){return parseFloat(i)+"%"},this.model=new l.ViewModel(this.$el,{title:"活动详情",back:this.route.query.from||"/"}),this.loading=new d({url:"/api/activity/get",params:{id:this.route.data.id},check:!1,checkData:!1,$el:this.$el,$content:this.$main.children(":first-child"),$scroll:this.$main,success:function(e){i.promise.then(function(){i.model.set(e)}),localStorage.setItem("destination",JSON.stringify(e.data))}}),this.loading.load(),this.$submit=this.$el.find(".js_submit"),this.submit=new d({url:"/api/activity/signup",params:{id:this.route.data.id},check:!1,checkData:!1,$el:this.$el,success:function(e){e.success?(sl.tip("报名成功！"),i.model.set("data.SignUpQty",i.model.data.data.SignUpQty+1)):sl.tip(e.msg),i.$submit.removeClass("disabled")}}),this.comments=new d({url:"/api/activity/comment_list",$el:i.$(".quan_list"),success:function(e){i.model.set("comments",e.data)},append:function(e){i.model.get("comments").append(e.data)}}),this.comments.load(),i.onResult("actcomment_success",function(){i.comments.reload()})},onLoad:function(){this.promise.resolve()},onShow:function(){this.user=n.store("user")},onDestory:function(){}})});define("template/register",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='\ufeff<header> <div sn-binding="html:title" class="head_title"></div> <div class="head_back" sn-binding="data-back:back"></div> </header> <div class="main"> <div class="login_form"> <ul class="form"> <li><input placeholder="输入手机号" sn-model="mobile" /></li> <li><input placeholder="验证码" sn-model="smsCode" type="text" /> <b class="js_valid btn_middle" sn-binding="html:valid"></b></li> <li><input placeholder="设置密码" sn-model="password" type="password" /></li> <li><input placeholder="再次输入确认密码" sn-model="password1" type="password" /></li> </ul> <div class="login_btn"><b class="btn_large js_bind">确定注册</b> </div> </div> </div> ';return __},helpers:{}});return T.template=T.html,T});define("template/guide",function(require){var T=(require("util"),{html:function($data){var __="";with($data||{})__+='\ufeff<header> <div class="head_back" sn-binding="data-back:back"></div> <div sn-binding="html:title" class="head_title"></div> </header> <div class="main guide"> <div class="guide_hd"> 恭喜您成为ABS爱彼此家居会员！<br> 我们为您准备了以下惊喜： </div> <div class="guide_bd"> <ul class="hd"> <li></li> <li>免费礼</li> <li>免费定制</li> <li>免费邮</li> </ul> <ul class="row"> <li> <span>SVIP会员</span> <p>累计金额<br>≥￥50000</p> </li> <li><p>600个月<br>免费礼</p></li> <li></li> <li></li> </ul> <ul class="row"> <li> <span>VIP会员</span> <p>￥10000≦<br>累计金额<br>＜￥50000</p> </li> <li><p>12个月<br>免费礼</p></li> <li></li> <li></li> </ul> <ul class="row"> <li> <span>钻石会员</span> <p>￥5000≦<br>累计金额<br>＜￥10000</p> </li> <li><p>12个月<br>免费礼</p></li> <li></li> <li class="none"></li> </ul> <ul class="row"> <li> <span>金卡会员</span> <p>￥1000≦<br>累计金额<br>＜￥5000</p> </li> <li><p>12个月<br>免费礼</p></li> <li></li> <li class="none"></li> </ul> <ul class="row"> <li> <span>银卡会员</span> <p>￥0＜<br>累计金额<br>＜￥1000</p> </li> <li class="none"><p></p></li> <li></li> <li class="none"></li> </ul> <div class="more"><p>ABS会员专享权益，最终解释权归上海爱彼此家居用品股份有限公司所有。</p> </div> </div> </div>';return __},helpers:{}});return T.template=T.html,T});define("views/guide",["images/style.css"],function(i,e,s){var a=(i("$"),i("util"),i("activity")),l=(i("widget/loading"),i("core/model")),r=i("widget/scroll");i("animation");return a.extend({events:{"tap .js_bind:not(.disabled)":function(){}},swipeRightBackAction:"/",onCreate:function(){var e=this.$(".main");r.bind(e),this.model=new l.ViewModel(this.$el,{back:"/",title:"新手指南"})},onShow:function(){},onDestory:function(){}})});define("views/register",["images/style.css"],function(i,e,s){var n=(i("$"),i("util")),a=i("activity"),d=i("../widget/loading"),l=i("../core/model"),r=i("../widget/scroll"),c=(i("animation"),i("util/md5"));return a.extend({events:{"tap .js_bind:not(.disabled)":function(){var i=this.model.data.mobile,e=this.model.data.password,s=this.model.data.password1,t=this.model.data.smsCode;return i&&n.validateMobile(i)?e!=s?void sl.tip("两次密码输入不一致"):t?void this.loading.setParam({mobile:i,password:c.md5(e),smsCode:t}).load():void sl.tip("请输入验证码"):void sl.tip("请输入正确的手机")},"tap .js_valid:not(.disabled)":function(i){var e=this.model.get("mobile");return e&&n.validateMobile(e)?(this.$valid.addClass("disabled"),this.valid.setParam({mobile:this.model.data.mobile}),void this.valid.load()):void sl.tip("请输入正确的手机")}},validTimeout:function(){var i=this,e=localStorage.getItem("valid_time");if(e&&parseInt(e)>60){if(e=Math.round((new Date(parseInt(e)).getTime()-Date.now())/1e3),0>=e)return;i.$valid.addClass("disabled"),setTimeout(function(){0>=e?(i.$valid.removeClass("disabled"),i.model.set("valid","获取验证码"),localStorage.removeItem("valid_time")):(i.model.set("valid",e+"秒"),e--,setTimeout(arguments.callee,1e3))},1e3)}},onCreate:function(){var i=this,e=this.$(".main");r.bind(e),this.model=new l.ViewModel(this.$el,{title:"注册",valid:"获取验证码",back:this.route.query.from||"/login"}),this.loading=new d({url:"/api/user/register",method:"POST",check:!1,checkData:!1,$el:this.$el,success:function(e){e.success?(localStorage.setItem("user",JSON.stringify(e.data)),i.back(i.route.query.success||"/")):sl.tip(e.msg)},error:function(i){sl.tip(i.msg)}}),this.valid=new d({url:"/api/user/send_sms",method:"POST",params:{mobile:i.model.data.mobile},check:!1,checkData:!1,$el:this.$el,success:function(e){e.success?(localStorage.setItem("valid_time",Date.now()+6e4),i.validTimeout()):sl.tip(e.msg)}}),i.$valid=this.$(".js_valid"),i.validTimeout()},onShow:function(){},onDestory:function(){}})});