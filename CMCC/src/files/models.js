define("models/home",["core/model2"],function(t,e,n){var i=t("core/model2"),r=i.createModel({attributes:{}});n.exports=r});define("models/news",["core/model2","util","$"],function(t,e,n){var i=t("core/model2"),r=t("util"),s=(t("$"),"NEWS_LIFE_CACHE"),a="NEWS_SERVICES_CACHE",c=i.createModel({attributes:{catalogs:[],banners:[],lifes:r.store(s)||[],services:r.store(a)||[]},getServices:function(){return this._("services")},getLifes:function(){return this._("lifes")}});c.observe("lifes",function(){r.store(s,this.get("lifes"))}),c.observe("services",function(){r.store(a,this.get("services"))}),n.exports=c});define("models/user",["core/model2","util","$"],function(t,e,n){var i=t("core/model2"),r=t("util"),s=(t("$"),i.createModel({attributes:r.store("user")}));s.observe(function(){r.store("user",this.attributes)}),n.exports=s});define("models/yunmi",["core/model2","util"],function(t,e,n){var i=t("core/model2"),r=t("util"),o=i.createModel({attributes:{amount:r.store("YM_AMOUNT")||0}});o.on("change:amount",function(t,e){r.store("YM_AMOUNT",e)}),n.exports=o});define("models/friends",["core/model2","util","$","./messagesList","./user"],function(t,e,n){var i=t("core/model2"),r=t("util"),s=(t("$"),t("./messagesList")),a=t("./user"),u=i.createModel({attributes:{contacts:[],friends:r.store("friends")||[],newFriendsCount:r.store("newFriendsCount")||0},getFriends:function(){return this._("friends")},getFriend:function(t){var e=this.getFriends(),n=e.find("user_id",t);return n||(n=e.add({user_id:t})),n},getContacts:function(){return this._("contacts")},getUserShowName:function(t){if(t.user_id==a.get("user_id"))return t.user_name||"用户"+t.user_id;var e=u.getFriend(t.user_id);return null==e?t.user_name||"用户"+t.user_id:e.get("name_for_show")},addNewFriendsCount:function(){return this.set({newFriendsCount:this.attributes.newFriendsCount+1})}});u.observe("friends",function(t){var e=this.get("friends");if(e){var i,n=[];e.forEach(function(t){i=(t.friends_ext?t.friends_ext.memo||t.user_name:t.user_name)||"用户"+t.user_id,t.name_for_show!=i&&n.push({user_id:t.user_id,name_for_show:t.name_for_show=i})}),n.length&&this._("friends").update(n,"user_id"),s.getList().update(e.map(function(t){return{user_id:t.user_id,avatars:t.avatars,user_name:t.name_for_show,push_to_home:t.friends_ext?2!==t.friends_ext.enable_push:!0,enable_leave_msg:t.friends_ext?2!==t.friends_ext.enable_leave_msg:!0}}),"user_id",!1),r.store("friends",e)}}),u.observe("contacts",function(t){r.store("contacts",this._("contacts").attributes)}),u.on("change:newFriendsCount",function(t,e){r.store("newFriendsCount",e)}),n.exports=u});define("models/business",["core/model2","util","$","./messagesList"],function(t,e,n){var i=t("core/model2"),r=t("util"),s=(t("$"),t("./messagesList")),a=i.createModel({}),u=i.createModel({attributes:r.store("business_model")||{list:[],notifications:[]},getNotifications:function(){return this._("notifications")},getGroups:function(){return a},getAll:function(){return this._("list")},find:function(t){return this._("list[business_id="+t+"][0]")}});s.observe("list",function(){u.set("dataver",Date.now())}),u.observe(function(){for(var t={},e=1;4>=e;e++)t["type"+e+"data"]={unread:0,list:[]};var n=0;s.getList().each(function(e){e.get("push_to_home")&&(t.type4data.unread+=e.get("unread")||0,e.get("date")>n&&(t.type4data.title=e.get("user_name")+":"+e.get("msg"),t.type4data.content=e.get("msg"),n=e.get("date")))});var i=u.get("notifications");u.getAll().each(function(e,n){var o=e.toJSON(),s=t["type"+o.type+"data"];o.send_date&&(!s.send_timestamp||s.send_timestamp<o.send_date)&&(s.title=o.title,s.content=o.content,s.send_timestamp=o.send_date,s.send_date=o.send_date?r.formatDate(o.send_date,"short"):"");var a=0;if(i)for(var n=0,u=i.length;u>n;n++)i[n]&&!i[n].isRead&&i[n].business_id==o.business_id&&a++;s.unread=(s.unread||0)+a,o.unread!=a&&(o.unread=a,e.set("unread",a)),s.list.push(o)}),a.set(t),r.store("business_model",this.attributes)}),n.exports=u});define("models/messagesList",["util","core/model2"],function(t,e,n){var i=t("util"),r=t("core/model2"),s=r.createModel({attributes:i.store("messagesList")||{list:[]},getList:function(){return this._("list")},getFriendLastMessage:function(t){var e=this.getList(),n=e.find("user_id",t);return n}});s.observe(function(){i.store("messagesList",this.attributes)}),n.exports=s});define("models/appconfig",["core/model2","util","$"],function(t,e,n){var i=t("core/model2"),r=t("util"),o=(t("$"),i.createModel({attributes:r.store("app_config")}));o.observe(function(){r.store("app_config",this.attributes)}),n.exports=o});define("models/hdh",["core/model2","util","$"],function(t,e,n){var i=t("core/model2"),r=t("util"),o=(t("$"),"HDH_MODEL_CACHE"),a=i.createModel({attruibutes:r.store(o)||{subPhoneList:[]},getHistory:function(){return this.collection("history")},getSubPhoneList:function(){return this._("subPhoneList")},getDefaultSubPhoneId:function(){return this._("subPhoneList").indexOf("isDefault",!0)+1},getDefaultSubPhone:function(){return this._("subPhoneList[isDefault=true][0]")||this._("subPhoneList[0]")},getSubInfo:function(t){var e=this._('subPhoneList[subphone="'+t+'"][+]',{subphone:t});return e}});a.observe(function(){r.store(o,this.attruibutes)}),n.exports=a});